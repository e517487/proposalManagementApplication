Option Explicit

Private mstr_Status As String
Private mstr_ErrLog As String
Private mstr_PCFINETNR As String
Private mbln_SkipRecord As Boolean

Dim mROL_RTHC  As String ' van tabel PARAMTR
Dim mROL_RTMC1 As String ' van tabel PARAMTR
Dim mROL_RTMC2 As String ' van tabel PARAMTR
Dim mROL_RTBC1 As String ' van tabel PARAMTR
Dim mROL_RTBC2 As String ' van tabel PARAMTR

Private Type Buffer_Record_Len233
    Buffer As String * 233
End Type

Private Type Record_01_Demande
    R01A001_DE_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
    R01N002_DE_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
    R01A003_DE_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à gauche (left), complété par des blancs à droite (rechts)
    R01N004_DE_CODE_ENREG      As String * 2   ' 0018-0019 (002) | Recordnummer                  |  Constante: ‘01’ | Code enregistrement | Constante vaut "01" | Valoriser à '01' | 0
    R01N005_DE_NO_CD_CLE       As String * 15  ' 0020-0034 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de demande | Numéro de demande (DE_NO_CD_CLE) | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
    R01A006_BLANC_39           As String * 91  ' 0035-0125 (091) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R01D007_DE_DT_DEMANDE      As String * 10  ' 0126-0135 (010) | Aanvraag datum                | PCRetail DB - AV_ALG . AANV_DATUM | Date de la demande | "Date d'enregistrement de la demande dans le système de gestion provisoire Si la date est absente, mettre 01.01.1801" | PCRetail - AV_ALG / AANV_DATUM | DD.MM.YYYY
    R01A008_BLANC_41           As String * 1   ' 0136-0136 (001) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R01D009_DE_DT_DERMODIF     As String * 10  ' 0137-0146 (010) | Upload datum                  | PCRetail DB - AV_ALG / UPL_DATUM | Date de dernière modification | Date de la dernière mise à jour des informations de la demande dans le système de gestion provisoire | PCRetail - AV_ALG / UPL_DATUM ??? À vérifier | DD.MM.YYYY
    R01A010_DE_CD_SUCCUR       As String * 6   ' 0147-0152 (006) | Filiaal                       | Constante: ‘PFNE’ | Code de la succursale | "Identifiant de la succursale commerciale dans laquelle a été effectuée la demande Exemple : Dans le cas de la France, les succursales sont : * Crédipar (pour les techniques de financement PP - VAC - LOA - CPA) * Locadin (techniques VAC - LOA) * SLV (techniques LLD - LOA - CB)" | Pour la Hollande, valoriser à 'PFNE' | justifié à gauche (left), complété par des blancs à droite (rechts)
    R01A011_DE_CD_FAMPROD      As String * 3   ' 0153-0155 (003) | Product type                  | PCRetail Functie: indien restant betaling aanwezig dan = balloon (4), Indien product = PL dan prêt personnel (6) anders = VAC (1) | Famille de produit financier | "La famille de produit financier : 0 : Non renseigné / Indéterminé 1 : VAC 2 : Leasing 3 : LLD 4 : Produit Ballon 5 : Autres 6 : Prêts Personnels 7 : Services Seuls" | "PCRetail - indien restant betaling aanwezig dan = balloon (4) /// Indien product = PL dan prêt personnel (6) /// anders = VAC (1) if restant betaling is present then = balloon (4) /// if product = PL then prêt personnel (6) /// else = VAC (1) - valoriser le champ à 1 - Si présence de VAC ballon, valoriser le champ à 4" | justifié à gauche (left), complété par des blancs à droite (rechts)
    R01A012_DE_NO_CONTRAT      As String * 15  ' 0156-0170 (015) | Contractnummer                | PCRetail DB - AV_ALG . CONTRACTNR | Numéro de contrat | "Numéro de contrat Ce numéro de contrat sert de clé entre le fichier des demandes et le fichier des contrats. Il doit donc être identique entre la gestion provisoire et la gestion définitive" | PCRetail - AV_ALG / CONTRACTNR | justifié à gauche (left), complété par des blancs à droite (rechts)
    R01A013_BLANC_46           As String * 30  ' 0171-0200 (030) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R01A014_DE_CD_DEVISO       As String * 3   ' 0201-0203 (003) | Valuta                        | Constante: ‘EUR’ | Code Devise ISO | Code ISO de la devise du dossier sur 3 caractères | = EUR | code ISO de la devise à intégrer dans la V2,0
    R01A015_BLANC_48           As String * 3   ' 0204-0206 (003) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R01D016_DE_DT_INHORSB      As String * 10  ' 0207-0216 (010) | Acceptatie datum              | PCRetail DB - AV_ALG . ACC_DATUM | Date d'entrée en hors bilan | Date d'entrée du dossier dans le portefeuille hors bilan | PCRetail - AV_ALG / ACC_DATUM ??? à vérifier | DD.MM.YYYY
    R01D017_DE_DT_OUTHORSB     As String * 10  ' 0217-0226 (010) | Aankoop datum                 | PCRetail DB - AV_ALG . AANK_DATUM | Date de sortie du Hors Bilan | Date de sortie du dossier du portefeuille hors bilan | PCRetail - AV_ALG / AANK_DATUM | DD.MM.YYYY
    R01N018_DE_CD_HORSB        As String * 1   ' 0227-0228 (001) | Indicator Hors Bilan          | Indien selectie criteria = hors bilan dan 1 (indien geaccepteerd maar nog niet aangekocht), Indien aanvraag geannuleerd (AV_ALG . ANN_DATUM) dan 0 | Indicateur Hors bilan | "* Renseignée pour les dossiers en Hors Bilan Uniquement. * Valeurs attendues: - vide pour les dossiers du bilan - 1 = Dossier hors bilan - 2 = Dossier en attente d'entrée en Chiffre d'Affaire - 0 = Dossier sorti du portefeuille hors bilan " | "1 indien selectie criteria hors bilan = indien geaccepteerd maar nog niet aangekocht 1 if corresponding selection criteria hors bilan = if demand accepted but not yet purchased 0 indien aanvraag geannuleerd is AV_ALG / ANN_DATUM" | 0
    R01N019_DE_CD_MOTIFOUTHRSB As String * 1   ' 0228-0229 (001) | Type aanvraag                 | Niet beschikbaar bij PFNE | Motif de sortie du hors bilan | Motif de sortie du dossier du portefeuille hors bilan. | Information non disponible | 0
    R01A020_SUIG               As String * 5   ' 0230-0233 (004) | Code SUIG                     | 110704: new code SUIG
    'R01A021_DUMMY_53          As String * 1   ' 0232-0233 (001) | Leeg                          | Vullen met x
End Type

Private Type Record_03_Demande
    R03A021_DE_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
    R03N022_DE_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
    R03N023_DE_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PC-Retail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
    R03N024_DE_CODE_ENREG      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘03’ | Code enregistrement | Constante vaut "03" | Valoriser à '03' | 0
    R03A025_BLANC_58           As String * 134 ' 0020-0153 (134) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R03A026_DE_CD_MOYPMT       As String * 6   ' 0154-0159 (006) | Betaal soort                  | PCRetail DB - AV_AANK . INCASSO dan 1 Anders 2 (= bank) | Code moyen de paiement | "Identifiant du type de paiement 0 : Non-renseigné / Indeterminé 1 : Prélèvement Automatique (SF) 2 : Virement bancaire (client) 3 : Chèque 4 : Bulletin postal 5 : Autres" | "PCRetail - AV_AANK / INCASSO 1 = automatische incasso /// 2 = rest 1 = prélèvement automatique /// 2 = others" | justifié à gauche (left), complété par des blancs à droite (rechts)
    R03N027_DE_NB_GARANT       As String * 3   ' 0160-0162 (003) | Aantal gekoppelde contactanten| 0-2. Zowel medecontractant als borg contracten tellen elk voor 1. Vaststellen borg: borg is een vd zekerheden | Nombre de garants | Nombre de garants interveant pour la demande | "PCRetail - medecontractant en of borg dus 1 of 2 of 0 indien geen van beide aanwezig 0 = only main customer present 1 = co-contractant or garant present 2 = co-contractant and garant present" | justifié à droite (rechts), complété par des zéros à gauche (left)
    R03A028_BLANC_61           As String * 18  ' 0163-0180 (018) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R03A029_DE_CD_STATUT       As String * 6   ' 0181-0186 (006) | Aanvraag status               | Constante: ‘1 ’ | Statut de la demande | "Statut de la demande au moment de l'extraction 0 : Non renseigné / Indéterminé 1 : Accepté 2 : En étude 3 : Refusée 4 : Annulée 5 : Autres" | Always = 1 | justifié à gauche (left), complété par des blancs à droite (rechts)
    R03N030_DE_MT_FRAISDOS     As String * 14  ' 0187-0200 (014) | Bedrag dossier                | Constante: +000000000,000 | Montant Frais de dossier | Montant Frais de dossier | Amount = 0 | +9(9),9(3)
    R03A031_DUMMY_64           As String * 33  ' 0201-0233 (033) | Leeg                          | Vullen met x | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
End Type

Private Type Record_05_Financement_de_Bien
    R05A039_FB_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’    |    Code filiale    |    "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)"    |    Pour la Hollande, valoriser à N    |    0
    R05N040_FB_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
    R05N041_FB_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
    R05N042_FB_CODE_ENREG      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘05’ | Code enregistrement | Constante vaut "05" | Valoriser à '05' | 0
    R05A043_FB_CD_PDFINAN      As String * 6   ' 0020-0025 (006) | Leeg                          | 0 | Code produit financier | "Code produit financier Il s'agit du code brut du produit de financement du bien rattaché à la demande" | Laisser à blanc - blanco laten | justifié à gauche (left), complété par des blancs à droite (rechts)
    R05N044_FB_MT_FINHORINT    As String * 14  ' 0026-0039 (014) | Financieel bedrag             | PCRetail DB - AV_FIN . FIN_BEDRAG | Montant financé hors intérêts | Montant total financé hors intérêts pour le bien rattaché, exprimé en Euros | PCRetail - AV_FIN / FIN_BEDRAG | +9(9),9(3)
    R05N045_FB_MT_APPORTINIT   As String * 14  ' 0040-0053 (014) | Aanbetaling                   | PCRetail DB - AV_FIN . AANBETAL | Montant de l'apport initial | Montant de l'apport initial sur la demande, exprimé en Euros | PCRetail - AV_FIN / AANBETAL | +9(9),9(3)
    R05A046_FB_TX_APPORT       As String * 8   ' 0054-0061 (008) | Koers                         | Niet beschikbaar bij PFNE | Taux Apport | Non lu par BRC | Information non disponible | 0
    R05N047_FB_MT_REPCONT      As String * 14  ' 0062-0075 (014) | hergefinancierd bedrag        | PCRetail DB - AV_FIN . HERFIN_BED | Montant de reprise de l'ancien contrat | Montant reprise TTC, correspond au montant de reprise du véhicule lors de la demande de financement | PCRetail - AV_FIN / HERFIN_BED | +9(9),9(3)
    R05A048_FB_NB_ECHEANCE     As String * 3   ' 0076-0078 (003) | Looptijd                      | PCRetail DB - AV_FIN . LOOPTIJD | Nombre d'échéances | Nombre d'échénances | PCRetail - AV_FIN / LOOPTIJD | 0
    R05A049_BLANC_82           As String * 1   ' 0079-0079 (001) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R05N050_FB_DU_PRET         As String * 8   ' 0080-0087 (008) | Looptijd                      | PCRetail DB - AV_FIN . LOOPTIJD | Durée du prêt | Durée du prêt prévue pour le financement du bien rattaché à la demande, exprimé en mois | PCRetail - AV_FIN / LOOPTIJD | +9(5),9(1)
    R05N051_FB_DU_PEREMB       As String * 8   ' 0088-0095 (008) | Constante                     | Constante: +000000001,000 | Fréquence de remboursement | Périodicité du premier palier prévu pour le financement du bien rattaché à la demande, exprimé en mois | "valoriser à +00001,0 always équal at +00001,0" | +9(5),9(1)
    R05N052_FB_TX_TAN          As String * 8   ' 0096-0103 (008) | Nominale rente                | PCRetail DB - AV_FIN . INTEREST * 100 | Taux du contrat | "Taux nominal proportionnel à la demande (Taux Tan). Valeur par défaut: +999999,9" | "PCRetail - nominale rente voet - op te zoeken nominal rate = to verifiy in data base" | +9(5),9(1)
    R05N053_FB_TX_TAEG         As String * 8   ' 0104-0111 (008) | Effectieve rente              | Round((((1 + (PCRetail DB - AV_FIN . INTEREST )) ^ 12) - 1) * 100, 2) | Taux effectif global du prêt | "Taux TAEG Valeur par défaut: +999,999" | "PCRetail - effectieve rente voet - op te zoeken effective rate = to verify in data base" | +9(3),9(3)
    R05D054_FB_DT_PREMECH      As String * 10  ' 0112-0121 (010) | Eerste termijn                | PCRetail DB - AV_FIN . BEGINDATUM | Date de première échéance | Date de la première échéance prévue pour le financement du bien rattaché à la demande | PCRetail - AV_FIN / BEGINDATUM ??? To verify | DD.MM.YYYY
    R05N055_FB_MT_PREMECH      As String * 14  ' 0122-0135 (014) | Termijnen                     | PCRetail DB - AV_FIN . TERMIJN | Montant de la première échéance | Montant de la première échéance prévue pour le financement du bien rattaché à la demande, exprimé en Euro | PCRetail - AV_FIN / TERMIJN | +9(9),9(3)
    R05N056_FB_MT_DEUXECH      As String * 14  ' 0136-0149 (014) | Restant                       | PCRetail DB - AV_FIN . RESTANT | Montant de la deuxième échéance | Montant de la deuxième échéance prévue pour le financement du bien rattaché à la demande, exprimé en Euro | PCRetail - AV_FIN / RESTANT | +9(9),9(3)
    R05A057_DUMMY_90           As String * 84  ' 0150-0233 (084) | Leeg                          | Vullen met x-en | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
End Type

Private Type Record_06_Financement_de_Bien
    R06A058_FB_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
    R06N059_FB_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
    R06N060_FB_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
    R06N061_FB_Code_enreg      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘06’ | Code enregistrement | Constante vaut "06" | Valoriser à '06' | 0
    R06D062_FB_DT_DERECH       As String * 10  ' 0020-0029 (010) | Datum laatste termijn         | PCRetail DB - AV_FIN . EINDDATUM | Date de dernière échéance | Date de dernière échéance | PCRetail - AV_FIN / EINDDATUM | DD.MM.YYYY
    R06N063_FB_MT_DERECH       As String * 14  ' 0030-0043 (014) | Bedrag laatste termijn        | PCRetail DB berekening: AV_FIN . RESTANT + AV_FIN . TERMIJN | Montant de la dernière échéance | Montant de la dernière échéance prévue pour le financement du bien rattaché à la demande, exprimé en Euro | PCRetail - AV_FIN / RESTANT + TERMIJN | +9(9),9(3)
    R06A064_FB_NB_MOISFRAN     As String * 3   ' 0044-0046 (003) | Aantal vrijstelling termijnen | Niet beschikbaar bij PFNE | Nbre de mois de franchise | Nbre de mois de franchise (Non lu par BRC) | Information non disponible | 0
    R06A065_BLANC_98           As String * 56  ' 0047-0102 (056) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R06N066_FB_MT_INTAPERC     As String * 14  ' 0103-0116 (014) | Gefinancierd bedrag 1         | PCRetail DB berekening: AV_FIN . TERMIJN * LOOPTIJD + AV_FIN . RESTANT - FIN_BEDRAG (Zie ook PCRetail afrekening) | Montant des intérêts à percevoir | "Montant total des intérêts à percevoir pour le financement du bien rattaché à la demande" | PCRetail - AV_FIN / TERMIJN * LOOPTIJD + RESTANT - FIN_BEDRAG | +9(9),9(3)
    R06N067_FB_MT_FINAVINT     As String * 14  ' 0117-0130 (014) | Gefinancierd bedrag 2         | PCRetail DB berekening: AV_FIN . TERMIJN * LOOPTIJD + AV_FIN . RESTANT | Montant financé avec intérêts | "Montant financé avec intérêts au moment de la dernière extraction, n'intègre pas les frais de dossier, exprimé en Euro" | PCRetail - AV_FIN / TERMIJN * LOOPTIJD + RESTANT | +9(9),9(3)
    R06N068_FB_NB_QUANTPRE     As String * 3   ' 0131-0133 (003) | Looptijd                      | PCRetail DB - AV_FIN . LOOPTIJD | Nombre de quantième de prélèvement | Nombre de quantième de prélèvement | PCRetail - AV_FIN / LOOPTIJD | +9(9),9(3)
    R06A069_BLANC_102          As String * 49  ' 0134-0182 (049) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R06N070_FB_MT_VR           As String * 14  ' 0183-0196 (014) | Restwaarde                    | Niet beschikbaar. | Montant valeur résiduelle | Montant valeur résiduelle | Information non disponible | +9(9),9(3)
    R06A071_DUMMY_104          As String * 37  ' 0197-0233 (037) | Leeg                          | Opvullen met x-en | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
End Type

Private Type Record_08_Vehicule
    R08A072_VE_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
    R08N073_VE_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
    R08N074_VE_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
    R08N075_VE_Code_enreg      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘08’ | Code enregistrement | Constante vaut "08" | Valoriser à '08' | 0
    R08A076_VE_CD_TYPVEHIC     As String * 2   ' 0020-0021 (002) | Type auto                     | PCRetail DB - AV_OBJ / CATEGORIE : VN = nieuw , VO = gebruikt | Type de bien | "Identifiant du type de véhicule (neuf ou occasion) VN : Véhicule Neuf ou Véhicule de Démonstration VO : Véhicule d'Occasion SV : indéfini" | "PCRetail - AV_OBJ / CATEGORIE /// VN = nieuw /// VO = gebruikt VN = new vehicle /// VO = Second hand vehicle" | 0
    R08A077_BLANC_110          As String * 8   ' 0022-0029 (008) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R08D078_VE_DT_PREMIMMA     As String * 10  ' 0030-0039 (010) | Datum inschrijving auto       | PCRetail - AV_OBJ / BOUWJAAR : 01.07.YYYY (yyyy = bouwjaar, enkel jaar is beschikbaar) | Date de première immatriculation du Véhicule d'Occasion | "Date de première immatriculation du véhicule Si la date est absente ou s'il s'agit d'un véhicule neuf , mettre 01.01.1801" | "PCRetail - AV_OBJ / BOUWJAAR /// 01.07.YYYY enkel jaar beschikbaar only the year is available in data base Renseigner par 01.07.YYYY" | DD.MM.YYYY
    R08A079_BLANC_112          As String * 31  ' 0040-0070 (031) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R08N080_VE_MT_PRIXCATA     As String * 14  ' 0071-0084 (014) | Cataloguswaarde               | Niet beschikbaar bij PFNE | Prix catalogue du véhicule | "Prix du véhicule rattaché à a demande, exprimé en Euro Pour les VO, il s'agit de la cotation officielle, Pour les VN, il s'agit du prix de vente au public de référence" | Information non disponible | +9(9),9(3)
    R08N081_VE_MT_PRIXACHA     As String * 14  ' 0085-0098 (014) | Nieuwprijs voertuig           | PCRetail DB - AV_FIN . VERKPRIJS | Prix d'achat du véhicule | "Prix d'achat du véhicule rattaché à la demande, exprimé en Euro Il s'agit du prix final proposé au client, il intégre les éventuels accessoires et options , ainsi que les remises. Il ne comprend pas la reprise éventuelle d'un véhicule" | PCRetail - AV_FIN / VERKPRIJS | +9(9),9(3)
    R08A082_BLANC_115          As String * 76  ' 0099-0174 (076) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R08A083_VE_CD_GENRE        As String * 2   ' 0175-0176 (002) | Soort auto (privé of zakelijk)| PCRetail DB - AV_OBJ . SOORTAUTO: via stamtabel “automobiel” | Code type utilisation de bien | "Identifiant du genre de véhicule rattaché à la demande: VU : Véhicule Utilitaire VP : Véhicule Particulier" | PCRetail - AV_OBJ / SOORTAUTO | 0
    R08A084_BLANC_117          As String * 28  ' 0177-0204 (028) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R08N085_VE_MT_OPTVEHCONS   As String * 11  ' 0205-0215 (011) | Bedrag auto toebehoren        | Niet beschikbaar bij PFNE | Montant des accessoires concessionnaires | Montant des accessoires concessionnaires | Information non disponible | +9(7),9(2)
    R08A086_BLANC_119          As String * 3   ' 0216-0218 (003) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R08N087_VE_MT_OPTVEHCE     As String * 11  ' 0219-0229 (011) | Bedrag auto accessoires       | Niet beschikbaar bij PFNE | Montant des accessoires véhicule | Montant des accessoires véhicule | Information non disponible | +9(7),9(2)
    R08A088_BLANC_121          As String * 3   ' 0230-0232 (003) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R08A089_DUMMY_122          As String * 1   ' 0233-0233 (001) | Leeg                          | Vullen met x-en | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
End Type

Private Type Record_10_Intervenant
    R10A090_IN_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
    R10N091_IN_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
    R10N092_IN_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
    R10N093_IN_Code_enreg      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘10’ | Code enregistrement | Constante vaut "10" | Valoriser à '10' | 0
    R10A094_IN_CD_ROLE         As String * 6   ' 0020-0025 (006) | Rol                           | PCRetail functie: Hoofdklant = 1 , Borg = 2 , medecontractant = 3 | Identifiant du rôle de l'intervenant | "Identifiant du rôle de l'intervenant 0 : Non renseigné / Intdéterminé 1 : client 2 : garant, participant 3 : co-demandeur, co-emprunteur 4 : autre cas" | "Hoofdklant = 1 /// Borg = 2 /// medecontractant = 3 Main customer = 1 /// Garant = 2 /// Co-contractant = 3" | justifié à gauche (left), complété par des blancs à droite (rechts)
    R10A095_IN_CD_TYPDEM       As String * 1   ' 0026-0026 (001) | Leeg                          | 0 | Type de demandeur | Type de demandeur | Valoriser à blanc | 0
    R10A096_IN_NO_CLIBCU       As String * 9   ' 0027-0035 (009) | Klantnummer                   | Niet beschikbaar bij PFNE | Numéro de client | N° client attribué au demandeur lors de l’enregistrement de la demande en gestion provisoire (si cela est effectué dès la gestion provisoire), sinon en gestion définitive. | Information non disponible - le n° d'intervenant (dans BI) est seulement attribué dans le traitement de l'interface de la mise en gestion définitive sur GVAC, donc après que le contract est parti de PC-Retail | justifié à gauche (left), complété par des blancs à droite (rechts)
    R10A097_BLANC_130          As String * 79  ' 0036-0114 (079) | Overslaan                     | Overslaan | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R10A098_IN_FICH_INT        As String * 6   ' 0115-0120 (006) | Overslaan                     | Overslaan | Code fichage Interne | Code fichage interne (FIP) | A définir par les modélisateurs | 0
    R10A099_IN_CD_FICHEXT      As String * 6   ' 0121-0126 (006) | Overslaan                     | Overslaan | Code fichier externe | Code fichier externe | A définir par les modélisateurs | 0
    R10A100_BLANC_133          As String * 7   ' 0127-0133 (007) | Overslaan                     | Overslaan | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R10N101_IN_MT_RKCONSOL     As String * 14  ' 0134-0147 (014) | Overslaan                     | Overslaan | Encours consolidé au client | Montant risque consolidé | Information non disponible | +9(9),9(3)
    R10A102_BLANC_135          As String * 14  ' 0148-0161 (014) | Overslaan                     | Overslaan | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R10A103_IN_CD_SCORE        As String * 6   ' 0162-0167 (006) | Overslaan                     | Overslaan | Identifiant du type de score | Identifiant du type de score | A définir par les modélisateurs | justifié à gauche (left), complété par des blancs à droite (rechts)
    R10N104_IN_NO_VERSCORE     As String * 3   ' 0168-0170 (003) | Overslaan                     | Overslaan | Numéro de version du score | "Numéro de version du score, commence à 1" | A définir par les modélisateurs | 9(3)
    R10D105_IN_DT_CLSCORE      As String * 10  ' 0171-0180 (010) | Overslaan                     | Overslaan | Date de calcul du score | "Date de calcul du score Si la date est absente, mettre 01.01.1801" | A définir par les modélisateurs | DD.MM.YYYY
    R10A106_IN_CD_TRANCHSCO    As String * 6   ' 0181-0186 (006) | Overslaan                     | Overslaan | Tranche de score | Tranche de score de la demande | A définir par les modélisateurs | justifié à gauche (left), complété par des blancs à droite (rechts)
    R10N107_IN_NB_NOTESCORE    As String * 5   ' 0187-0191 (005) | Overslaan                     | Overslaan | Note de score | "Note de score en nombre de points" | A définir par les modélisateurs | +9(4)
    R10A108_IN_FICH_EXT1       As String * 2   ' 0192-0193 (002) | Overslaan                     | Overslaan | Note Externe CRIF | "données spécifique à l'Italie - Lues pour toutes les filiales Code fichage externe 1 COTE D’ACTIVITE BDF Pour un dirigeant d’entreprise (profession libéral et artisan inclus)" | A définir par les modélisateurs | 0
    R10A109_BLANC_142          As String * 4   ' 0194-0197 (004) | Overslaan                     | Overslaan | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R10A110_IN_FICH_EXT4       As String * 4   ' 0198-0201 (004) | Score                         | Zie scoring in PCRetail. De functie ScoreCard berekent de score. Formaat totaal score = letter+punten bv A234 | Score CREFO / Pour L'Italie SCORE EXPERIAN (nouveau) | Score CREFO / Pour L'Italie SCORE EXPERIAN (nouveau) | "Formaat totaal score = letter+punten bv A234 /// nog uit te zoeken in PC-Retail Format of total score = character + total points ex A234 /// to verifiy in PCRetail data base " | 0
    R10A111_BLANC_144          As String * 7   ' 0202-0208 (007) | Overslaan                     | Overslaan | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R10A112_IN_FICH_EXT9       As String * 2   ' 0209-0210 (002) | Overslaan                     | Overslaan | SCORE EXPERIAN ancien | "Code fichage externe 9 CODE IMPAYE Pour une entreprise Ajoutée pour PFIT. Lue pour toutes les filiales" | A définir par les modélisateurs | 0
    R10A113_BLANC_146          As String * 16  ' 0211-0226 (016) | Overslaan                     | Overslaan | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R10A114_IN_FICH_EXT11      As String * 4   ' 0227-0230 (004) | Overslaan                     | Overslaan | score FIBEN | "Code FICHAGE EXTERNE 11 données spécifique à la France, lues pour toutes les filiales. Ce champ contient à la fois la cotation FIBEN Dirigeant et la cotation FIBEN Entreprise Nouvelle cotation BDF mis en place à partir du 5 avril 2004" | A définir par les modélisateurs | 0
    R10A115_DUMMY_148          As String * 3   ' 0231-0233 (003) | Overslaan                     | Overslaan | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
End Type

Private Type Record_11_Particulier
    R11A116_PA_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
    R11N117_PA_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
    R11N118_PA_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
    R11N119_PA_Code_enreg      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘11’ | Code enregistrement | Constante vaut "11" | Valoriser à '11' | 0
    R11A120_PA_NO_IDENT        As String * 20  ' 0020-0039 (020) | Overslaan                     | 0 | Identifiant national | Identifiant national du demandeur, blanc si non géré dans la filiale | Information non disponible | justifié à gauche (left), complété par des blancs à droite (rechts)
    R11D121_PA_DT_NAISS        As String * 10  ' 0040-0049 (010) | Geboortedatum                 | PCRetail DB - RELATIE . GEBDATUM | Date de naissance pour le particulier | "Date de naissance pour le particulier Si la date est absente, mettre 01.01.1801" | PCRetail - RELATIE / GEBDATUM | DD.MM.YYYY
    R11A122_BLANC_155          As String * 94  ' 0050-0143 (094) | Leeg                          | Leeg | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R11D123_PA_DT_EXPSEJOUR    As String * 10  ' 0144-0153 (010) | Leeg                          | Leeg | Date d'expiration du permis de séjour | "Date d'expiration du permis de séjour, Si la date est absente, mettre 01.01.1801" | Information non disponible | DD.MM.YYYY
    R11A124_BLANC_157          As String * 22  ' 0154-0175 (022) | Leeg                          | Leeg | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R11A125_DUMMY_158          As String * 58  ' 0176-0233 (058) | Leeg                          | Leeg | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
End Type

Private Type Record_12_Particulier
    R12A126_PA_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
    R12N127_PA_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
    R12N128_PA_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
    R12N129_PA_Code_enreg      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘12’ | Code enregistrement | Constante vaut "12" | Valoriser à '12' | 0
    R12A130_PA_CD_POSTAL       As String * 10  ' 0020-0029 (010) | Postcode                      | PCRetail DB - RELATIE . POSTCODE | Code postal | "Code postal de la résidence du demandeur au moment de la dernière mise à jour de la demande" | PCRetail - RELATIE / POSTCODE | justifié à gauche (left), complété par des blancs à droite (rechts)
    R12A131_BLANC_164          As String * 70  ' 0030-0099 (070) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R12A132_PA_CD_SITUFAM      As String * 6   ' 0100-0105 (006) | Burgerlijke stand             | PCRetail DB - RELATIE . BURGSTATUS **Vergelijk stamtabel PCRetail met deze | Statut familial du demandeur | "Statut familial du demandeur 0 : Non renseigné / Indeterminé 1 : Marié 2 : Célibataire 3 : Veuf 4 : Divorcé 5 : Séparé 6 : Concubin 7 : Autres" | PCRetail - RELATIE / BURGSTATUS | justifié à gauche (left), complété par des blancs à droite (rechts)
    R12N133_PA_NB_ENFANT       As String * 3   ' 0106-0108 (003) | Kinderen                      | PCRetail DB - RELATIE . KINDEREN | Nombre d'enfants à charge | Nombre d'enfants à charge | PCRetail - RELATIE / KINDEREN | 9(3)
    R12N134_PA_NB_PERSCHARG    As String * 3   ' 0109-0111 (003) | Aantal personen               | Niet beschikbaar bij PFNE * Wat in te vullen? Hoofdcontractant, medecontractant + kinderen? | Nombre de personnes à charge | Nombre de personnes à charge | Information non disponible | 9(3)
    R12A135_PA_CD_SITULOGMT    As String * 6   ' 0112-0117 (006) | Woonsituatie                  | PCRetail DB - RELATIE . BEHUIZING **Vergelijk stamtabel PCRetail met deze | Code situation logement | "Situation au logement du demandeur 0 : Non renseigné / Indéterminé 1 : Propriétaire d'un appartement 2 : Propriétaire d'une maison 3 : Propriétaire 4 : Locataire 5 : Loge chez Parents 6 : Loge chez Employeur 7 : Loge chez tiers 8 : Loge chez quelqu'un (quand pas détail) 9 : Caravane 10 : Hôtel 11 : Foyer 12 : Autres" | PCRetail - RELATIE / BEHUIZING | justifié à gauche (left), complété par des blancs à droite (rechts)
    R12A136_BLANC_169          As String * 1   ' 0118-0118 (001) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R12N137_PA_DU_ANCLOGMT     As String * 6   ' 0119-0124 (006) | Woonduur                      | PCRetail DB - RELATIE . WOON_DUUR | Ancienneté dans le logement | "Ancienneté de l'intervenant dans le logement, exprimée en mois Si calculée = Date de la demande - date d'entrée au logement" | PCRetail - RELATIE / WOON_DUUR | +9(3),9(1)
    R12A138_PA_CD_SITUPROF     As String * 6   ' 0125-0130 (006) | Werksituatie                  | Niet beschikbaar bij PFNE | Code situation professionnelle spécifique aux filiales | Code situation professionnelle spécifique aux filiales | Information non disponible | 0
    R12A139_PA_CD_SITUPROFCOM  As String * 6   ' 0131-0136 (006) | Code Beroep                   | Niet beschikbaar bij PFNE, waarde = 0 | Code situation professionnelle commun aux filiales | "Code situation professionnelle dans le référentiel commun 0 : Non renseigné / Indéterminé 1 : Ouvrier 2 : Retraité 3 : Fonctionnaire 4 : Officier 5 : Soldat 6 : Indépendant 7 : Femme au foyer 8 : Etudiant 9 : Employé - Salarié 10 : Cadre moyen 11 : Cadre supérieur 12 : Agriculteur 13 : Artisan - Petit commerçant 14 : Patron - Gros commerçant 15 : Profession libérale 16 : Inactif 17 : Rentier 18 : Autres" | = 0 | justifié à gauche (left), complété par des blancs à droite (rechts)
    R12N140_PA_DU_ANCEMPL      As String * 6   ' 0137-0142 (006) | Datum in dienst               | PCRetail DB - RELATIE . STARWERK Berekenen; is een datum in dienst. In jaren? Wat is de waarde bij niet beschikbaar? | Ancienneté dans l'emploi | "Ancienneté de l'intervenant dans l'emploi qu'il occupe au moment de la dernière mise à jour de la demande, exprimée en mois Si calculée = Date de la demande - date d'entrée en fonction " | PCRetail - RELATIE / STARWERK | +9(3),9(1)
    R12A141_BLANC_174          As String * 16  ' 0143-0158 (016) | Leeg                          | Leeg of niet beschikbaar | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R12A142_PA_CD_SECACT       As String * 6   ' 0159-0164 (006) | Leeg                          | Leeg of niet beschikbaar | Code secteur d'activité spécifique aux filiales | "Code brut du secteur d'activité de l'intervenant particulier => Fournir la table de référence spécifique à la filiale " | Information non disponible | justifié à gauche (left), complété par des blancs à droite (rechts)
    R12A143_PA_CD_SECTACTCOM   As String * 6   ' 0165-0170 (006) | Leeg                          | Leeg of niet beschikbaar | Code secteur d'activité commun aux filiales | "Code du secteur d'activité de l'intervenant particulier dans le référentiel commun 0 : Non renseigné - Indéterminé 1 : Agriculture - Chasse - Sylviculture 2 : Pêche - Aquaculture 3 : Industries extractives 4 : Industries manufacturées 5 : Production Distribution électrique 6 : Construction 7 : Commerce - Réparation automobile 8 : Hôtel - Restaurant 9 : Transport - Communication 10 : Activités financières 11 : Immobilier 12 : Administration publique 13 : Education 14 : Santé - Action sociale 15 : Services collectifs sociaux 16 : Services domestiques 17 : Activités extra-territoriales 18 : Autres 19 : Média - Communication 20 : Marketing - Ventes" | Information non disponible | justifié à gauche (left), complété par des blancs à droite (rechts)
    R12A144_PA_CD_TYPCONTPRO   As String * 6   ' 0171-0176 (006) | Leeg                          | Leeg of niet beschikbaar | Type de contrat | Type de contrat professionnel de l'intervenant (ex: CDD, CDI, Apprenti …) | Information non disponible | 0
    R12A145_DUMMY_178          As String * 57  ' 0177-0233 (057) | Leeg                          | Leeg of niet beschikbaar | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
End Type

Private Type Record_13_Particulier
    R13A146_PA_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
    R13N147_PA_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
    R13N148_PA_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB – AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
    R13N149_PA_Code_enreg      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘13’ | Code enregistrement | Constante vaut "13" | Valoriser à '13' | 0
    R13A150_BLANC_183          As String * 40  ' 0020-0059 (040) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R13N151_PA_MT_SALNET       As String * 14  ' 0060-0073 (014) | Netto loon                    | Alleen beschikbaar in PCFinet | Salaire mensuel net | "Montant du salaire mensuel de l'intervenant au moment de la dernière mise à jour de la demande, exprimé en Euro " | "nieuw vanuit PC-Finet over te nemen in PC-Retail - interface aanpassen new element to recuperate from PC-Finet - evolution of interface" | +9(9),9(3)
    R13A152_BLANC_185          As String * 28  ' 0074-0101 (028) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R13N153_PA_MT_TOTREV       As String * 14  ' 0102-0115 (014) | Totaal maandelijkse inkomsten | Alleen beschikbaar in PCFinet | Montant total des revenus mensuels | "Montant total des revenus mensuels de l'intervenant au moment de la dernière mise à jour de la demande, exprimé en Euro " | "nieuw vanuit PC-Finet over te nemen in PC-Retail - interface aanpassen new element to recuperate from PC-Finet - evolution of interface" | +9(9),9(3)
    R13N154_PA_MT_SALMEN       As String * 14  ' 0116-0129 (014) | Netto loon huishouden per mnd | Alleen beschikbaar in PCFinet | Salaire mensuel net du ménage | "Montant du salaire mensuel du ménage de l'intervenat au moment de la dernière mise à jour de la demande, exprimé en Euro " | "nieuw vanuit PC-Finet over te nemen in PC-Retail - interface aanpassen new element to recuperate from PC-Finet - evolution of interface" | +9(9),9(3)
    R13A155_BLANC_188          As String * 28  ' 0130-0157 (028) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R13N156_PA_MT_TOREVMEN     As String * 14  ' 0158-0171 (014) | Totaal mnd inkomsten huishdn  | Alleen beschikbaar in PCFinet | Montant total des revenus mensuels du ménage | "Montant total des revenus mensuels du ménage de l'intervenant au moment de la dernière mise à jour de la demande, exprimé en Euro " | "nieuw vanuit PC-Finet over te nemen in PC-Retail - interface aanpassen new element to recuperate from PC-Finet - evolution of interface" | +9(9),9(3)
    R13N157_PERSONINKOM        As String * 2   ' 0171-0172 (002) | Aantal inkomens, op verzoek FR Mustafa 2010-10-03
    R13A158_DUMMY_190          As String * 60  ' 0174-0233 (060) | Leeg                          | Leeg | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
End Type

Private Type Record_14_Particulier
    R14A158_PA_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
    R14N159_PA_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
    R14N160_PA_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
    R14N161_PA_Code_enreg      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘14’ | Code enregistrement | Constante vaut "14" | Valoriser à '14' | 0
    R14A162_BLANC_195          As String * 14  ' 0020-0033 (014) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R14N163_PA_MT_MENSPRET     As String * 14  ' 0034-0047 (014) | Mnd afbet. Lopende leningen   | Mogelijk beschikbaar in PCFinet | Mensualité des prêts en cours | "Mensualité des prêts en cours " | BKR / WFD - à vérifier avec Michel Preux si disponible dans PC-Finet | +9(9),9(3)
    R14A164_BLANC_197          As String * 52  ' 0048-0099 (052) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R14N165_PA_MT_PRETMEN      As String * 14  ' 0100-0113 (014) | Mnd afbet. Lopnde lening tot. | Mogelijk beschikbaar in PCFinet | Mensualité des prêts en cours du ménage | "Mensualité des prêts en cours du ménage" | BKR / WFD - à vérifier avec Michel Preux si disponible dans PC-Finet | +9(9),9(3)
    R14N166_PA_MT_AUCHAMEN     As String * 14  ' 0114-0127 (014) | Mnd andere lasten huishouden  | Mogelijk beschikbaar in PCFinet | Montant mensuel des autres charges du ménage | "Montant mensuel des autres charges du ménage, exprimé en Euro" | BKR / WFD WOONLASTEN - à vérifier avec Michel Preux si disponible dans PC-Finet | +9(9),9(3)
    R14N167_PA_MT_TOTCHAMEN    As String * 14  ' 0128-0141 (014) | Totaal Mnd lasten huishouden  | Mogelijk beschikbaar in PCFinet | Montant total des charges mensuelles du ménage | "Montant total des charges mensuelles du ménage, exprimé en Euro" | BKR / WFD WOONLASTEN - à vérifier avec Michel Preux si disponible dans PC-Finet | +9(9),9(3)
    R14N168_PA_TX_ENDETSF      As String * 8   ' 0142-0149 (008) | Taux d'endettement SF         | Mogelijk beschikbaar in PCFinet | Taux d'endettement SF | Montant de la plus grosse échéance de la demande exceptée la dernière / Revenu net mensuel global du demandeur | BKR / WFD - à vérifier avec Michel Preux si disponible dans PC-Finet | +9(3),9(3)
    R14N169_PA_TX_ENDETGL      As String * 8   ' 0150-0157 (008) | Status globale schuld         | Niet beschikbaar bij PFNE | Taux d'endettement global | (Montant global des charges mensuelles du demandeur + montant de la plus grosse échéance de la demande exceptée la dernière) / Revenu net mensuel global du demandeur | Information non disponible | +9(3),9(3)
    R14A170_BLANC_203          As String * 56  ' 0158-0213 (056) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R14A171_DUMMY_204          As String * 20  ' 0214-0233 (020) | Leeg                          | Vullen met x-en | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
End Type

Private Type Record_15_Entreprise
    R15A172_EN_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
    R15N173_EN_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
    R15N174_EN_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
    R15N175_EN_Code_enreg      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘15’ | Code enregistrement | Constante vaut "15" | Valoriser à '15' | 0
    R15A176_EN_CD_IDNATIONAL   As String * 20  ' 0020-0039 (020) | Inschrijf nummer              | PCRetail DB - BEDRIJF . KVK_INSCHR | Numéro d'identifiant national | Numéro d'identifiant national pour une entreprise (exemple : en France c'est le numéro SIREN) | PCRetail - BEDRIJF / KVK_INSCHR | 0
    R15D177_EN_DT_CREAT        As String * 10  ' 0040-0049 (010) | Inschrijf datum               | PCRetail DB - BEDRIJF . KVK_OPRDATUM | Date de création de l'entreprise | "Date de création de l'entreprise Si la date est absente, mettre 01.01.1801" | PCRetail - BEDRIJF / KVK_OPRDATUM | DD.MM.YYYY
    R15A178_BLANC_211          As String * 9   ' 0050-0058 (009) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R15A179_EN_CD_FORMJURI     As String * 6   ' 0059-0064 (006) | Rechtsvorm                    | PCRetail DB - BEDRIJF . RECHTSVORM | Code forme juridique | "Forme juridique de l'entreprise du demandeur au moment de la dernière mise à jour de la demande => Fournir la table de référence spécifique à la filiale" | "PCRetail - BEDRIJF / RECHTSVORM Fournir la table des formes juridiques spécifique à la filiale" | justifié à gauche (left), complété par des blancs à droite (rechts)
    R15A180_EN_CD_SECACTE      As String * 6   ' 0065-0070 (006) | Niet beschikbaar / Leeg       | 0 | Code secteur d'activité spécifique aux filiales | "Code brut du secteur d'activité de l'intervenant entreprise => Fournir la table de référence spécifique à la filiale" | Information non disponible | justifié à gauche (left), complété par des blancs à droite (rechts)
    R15A181_EN_CD_SECACTECOM   As String * 6   ' 0071-0076 (006) | Niet beschikbaar / Leeg       | 0 | Code secteur d'activité commun aux filiales | "Code du secteur d'activité de l'intervenant entreprise dans le référentiel commun 0 : Non renseigné - Indéterminé 1 : Agriculture - Chasse - Sylviculture 2 : Pêche - Aquaculture 3 : Industries extractives 4 : Industries manufacturées 5 : Production Distribution électrique 6 : Construction 7 : Commerce - Réparation automobile 8 : Hôtel - Restaurant 9 : Transport - Communication 10 : Activités financières 11 : Immobilier 12 : Administration publique 13 : Education 14 : Santé - Action sociale 15 : Services collectifs sociaux 16 : Services domestiques 17 : Activités extra-territoriales 18 : Autres 19 : Média - Communication 20 : Marketing - Ventes" | Information non disponible | justifié à gauche (left), complété par des blancs à droite (rechts)
    R15N182_EN_MT_CAPITAL      As String * 14  ' 0077-0090 (014) | Niet beschikbaar / Leeg       | 0 | Montant du capital de la société | "Montant du capital de la société" | Information non disponible | +9(9),9(3)
    R15N183_EN_MT_CA           As String * 14  ' 0091-0104 (014) | Niet beschikbaar / Leeg       | 0 | Montant du chiffre d'affaires | "Montant du chiffre d'affaire de l'entreprise publié au moment de l'extraction, exprimé en euro" | Information non disponible | +9(9),9(3)
    R15A184_BLANC_217          As String * 24  ' 0105-0128 (024) | Niet beschikbaar / Leeg       | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R15N185_EN_NB_EFFECTIF     As String * 5   ' 0129-0133 (005) | Niet beschikbaar / Leeg       | 0 | Nombre d'employés dans l'entreprise | "Effectif de l'entreprise du demandeur au moement de la dernière mise à jour de la demande" | Information non disponible | 9(5)
    R15A186_EN_CD_TRANCHEFF    As String * 6   ' 0134-0139 (006) | Niet beschikbaar / Leeg       | 0 | Tranche d'effectif dans l'entreprise | "Tranche d'effectif à laquelle appartient l'entreprise au moment de la dernière mise à jour de la demande Ce champ n'est pas renseigné si l'effectif de l'entreprise est fournie sinon, suivre le référentiel ci-dessous 0 : Non renseigné / Indéterminé 1 : 1 Employé 2 : 2 à 5 Employés 3 : 6 à 10 Employés 4 : 11 à 50 Employés 5 : 51 à 100 Employés 6 : >= 101 Employés" | Information non disponible | justifié à gauche (left), complété par des blancs à droite (rechts)
    R15A187_DUMMY_220          As String * 94  ' 0140-0233 (094) | Niet beschikbaar / Leeg       | 0 | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
End Type

Private Type Record_16_Decision
    R16A188_DD_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
    R16N189_DD_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
    R16N190_DD_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
    R16N191_DD_Code_enreg      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘16’ | Code enregistrement | Constante vaut "16" | Valoriser à '16' | 0
    R16A192_BLANC_225          As String * 1   ' 0020-0020 (001) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R16D193_DD_DT_DECISYST     As String * 10  ' 0021-0030 (010) | Beslissing in systeem         | Constante: ’01.01.1801’ | Date de décision système | Date de décision système | "Default waarde = 01.01.1801 Renseigner par la valeur par défaut: 01.01.1801" | DD.MM.YYYY
    R16A194_BLANC_227          As String * 6   ' 0031-0036 (006) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R16D195_DD_DT_DECIACC      As String * 10  ' 0037-0046 (010) | Datum akkoord                 | Constante: ’01.01.1801’ | Date de décision accord | Date de décision accord | "Default waarde = 01.01.1801 Renseigner par la valeur par défaut: 01.01.1801" | DD.MM.YYYY
    R16A196_BLANC_229          As String * 120 ' 0047-0166 (120) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R16A197_IN_CD_TRASCORE3    As String * 2   ' 0167-0168 (002) | Score                         | Formaat score = letter (Zie punt 110) | Tranche de score finale | Tranche de score finale | Formaat score = letter bv A // nog uit te zoeken in PC-Retail | 0
    R16A198_BLANC_231          As String * 65  ' 0169-0233 (065) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
End Type

Private Type Record_22_Palier
    R22A199_PL_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
    R22N200_PL_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
    R22N201_PL_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
    R22N202_PL_Code_enreg      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘22’ | Code enregistrement | Constante vaut "22" | Valoriser à '22' | 0
    R22N203_PL_NO_PALIER       As String * 3   ' 0020-0022 (003) | Nummer palier                 | 01 voor normaal contract 01 of 02 voor balloon (2 records voor balloon) | Numéro de palier | Numéro de palier | " = 01 vor normaal contract /// 01 en 02 voor balloon (2 records voor balloon) = 01 for normal contract /// 01 or 02 for balloon (2 records for balloon)" | justifié à droite (rechts), complété par des zéros à gauche (left)
    R22A204_BLANC_237          As String * 6   ' 0023-0028 (006) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
    R22N205_PL_MT_ECH          As String * 14  ' 0029-0042 (014) | Termijn bedrag palier         | 1e record : PCRetail - AV_FIN / TERMIJN voor normaal contract en balloon ; 2e record : TERMIJN + RESTANT enkel voor balloon | Montant de l'échéance du palier | Montant de l'échéance du palier, exprimé en Euro | "PCRetail - AV_FIN / 1e record 22 : TERMIJN voor normaal contract en balloon /// 2e record 22 : TERMIJN + RESTANT enkel voor balloon 1st record 22 : TERMIJN for normal contract and for balloon // 2nd record 22 : TERMIJN + RESTANT only for balloon" | +9(9),9(3)
    R22N206_PL_DU_PALIER       As String * 3   ' 0043-0045 (003) | Duur in mnd vd palier         | 1e record : LOOPTIJD voor normale contracten en (LOOPTIJD - 1) voor balloon ; 2e record : enkel voor balloon : 1 voor balloon | Durée du palier exprimé en mois | Durée du palier exprimé en mois | "PCRetail - 1e record 22 : LOOPTIJD voor normale contracten en (LOOPTIJD - 1) voor balloon /// 2e record 22 enkel voor balloon : 1 voor balloon 1st record 22 : LOOPTIJD for normal contracts and (LOOPTIJD - 1) for balloon /// 2nd record 22 only for balloon : 1 for balloon" | 9(3)
    R22N207_PL_NB_ECH          As String * 3   ' 0046-0048 (003) | Aantal termijnen in de palier | 1e record : LOOPTIJD voor normale contracten en (LOOPTIJD - 1) voor balloon ; 2e record : enkel voor balloon : 1 voor balloon | Nombre d'échéances dans le palier | Nombre d'échéances dans le palier | "PCRetail - 1e record 22 : LOOPTIJD voor normale contracten en (LOOPTIJD - 1) voor balloon /// 2e record 22 enkel voor balloon : 1 voor balloon 1st record 22 : LOOPTIJD for normal contracts and (LOOPTIJD - 1) for balloon /// 2nd record 22 only for balloon : 1 for balloon" | 9(3)
    R22D208_PL_DT_DEB          As String * 10  ' 0049-0058 (010) | Begindatum palier             | 1e record : PCRetail DB - AV_ALG . TEK_DATUM | Date de début de palier | "Date de début de palier, Si la date est absente, mettre 01.01.1801" | PCRetail - AV_ALG / TEK_DATUM voor 1e record 22 - for 1st record 22 | DD.MM.YYYY
    R22D209_PL_DT_FIN          As String * 10  ' 0059-0068 (010) | Einddatum palier              | 1e record : PCRetail DB - AV_FIN / EIND_DATUM ; 2e record : (EIND_DATUM - 1) voor balloon | Date de fin de palier | "Date de fin de palier Si la date est absente, mettre 01.01.1801" | "PCRetail - AV_FIN / EIND_DATUM voor 1e record 22 /// (EIND_DATUM - 1) voor 2e record balloon EIND_DATUM for 1st record 22 /// (EIND_DATUM - 1) for 2nd record balloon" | DD.MM.YYYY
    R22A210_DUMMY_243          As String * 165 ' 0069-0233 (165) | Leeg                          | Vullen met x-en | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
End Type

Private Type Record_23_Bale_II
    R23A211_DE_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
    R23N212_DE_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
    R23N213_DE_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
    R23N214_DE_Code_enreg      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘23’ | Code enregistrement | Constante vaut "23" | Valoriser à '23' | 0
    R23N215_GA_MT_GARANT       As String * 14  ' 0020-0033 (014) | Bedrag                        | PCRetail DB - AV_FIN . MAANDBEDRAG * LOOPTIJD + RESTANT – FIN_BEDRAG | Montant de la garantie | "Il s'agit du montant pour lequel il y a un garant (ne correspond pas forcément au montant du prêt financé, exemple du concessionnaire en Allemagne) si garantie à 100% du montant, mettre le montant" | PCRetail - AV_FIN / MAANDBEDRAG * LOOPTIJD + RESTANT - FIN_BEDRAG | +9(9),9(3)
    R23A216_GA_CD_NATURE       As String * 6   ' 0034-0039 (006) | Code bedrag                   | Leeg | Code nature de la garantie | Renseigner le champ à blanc | blanco | justifié à gauche (left), complété par des blancs à droite (rechts)
    R23A217_DE_CD_TYPDEM       As String * 1   ' 0040-0040 (001) | Client code                   | 0 = Bedrijf : Nog te bepalen ; 1= Particulier: Niet-bedrijf ;2 = Medewerker: dealer= 009200 of 900200 | Code client | "Type du demandeur : 0 : Entreprise 1 : Particulier 2 : Employé" | "PCRetail - uit zoeken bedrijf - patriculier /// voor employé PSA (= 2) dealer = 009200 en 900200 to look-up whow to make the difference between Etreprise and Particulier /// For emplyees PSA (= 2) dealer = 009200 and 900200" | justifié à gauche (left), complété par des blancs à droite (rechts)
    R23N218_DE_MT_DEPGAR       As String * 14  ' 0041-0054 (014) | Niet beschikbaar              | Waarde op 0? | Valeur du dépôt de garantie | Apport pour le leasing | Information non disponible | +9(9),9(3)
    R23N219_DE_NB_VEHICULE     As String * 3   ' 0055-0057 (003) | Niet beschikbaar              | Constante: 999 | Nombre de véhicules | "Nombre de véhicules au total du client en cours de paiement Valeur par défaut: 999" | Information non disponible | 9(3)
    R23D220_DE_DT_EXTRACT      As String * 10  ' 0058-0067 (010) | Datum gegevens                | Datum extractie | Date d'extraction des données | "Date à laquelle l'extraction a été faite Date du jour. Elle est requise. " | "extractiedatum van bestand creation date of the extraction file" | DD.MM.YYYY
    R23A221_DE_TM_RETCOR       As String * 1   ' 0068-0068 (001) | Retail of corporate           | Vullen met spaties | Champ Retail / Corporate | "flag mis à R : Retail C : Corporate Cette notion est en cours de définition auprès des fonctionnels, ce champ doit être initialisé à blanc" | "altijd = blanco laten always = spaces Renseigner plutôt par la valeur par défaut: un espace vide" | 0
    R23A222_TM_LIGNEC          As String * 1   ' 0069-0069 (001) | Leeg                          | 0 | Ligne de crédit | "Témoin indiquant si le financement demandé correspond à un montant de financement ou à un véhicule. 0 : la demande de financement ne correspond pas à une ligne de crédit 1 : La demande de financement est une ligne de crédit. Pour l'instant, renseigner ce champ à blanc" | blanco | 0
    R23N223_CA_CONSO           As String * 20  ' 0070-0089 (020) | CA consolidé du groupe        | Constante: +999999999999999,999 | CA consolidé du groupe | "Montant du CA du groupe auquel la société est rattaché Pour l'instant, renseigner ce champ à +999999999999999,999" | Information non disponible | +9(15),9(3)
    R23A224_DE_CD_DEVISE       As String * 3   ' 0090-0092 (003) | Valuta                        | Constante:’EUR’ | Code Devise ISO | DE_CD_DEVISE | Valoriser par 'EUR' | 0
    R23D225_DE_DT_LIQUIDATION  As String * 10  ' 0093-0102 (010) | Liquidatie datum              | Niet beschikbaar bij PFNE | Date de Liquidation | Date de liquidation du contrat Wholesale | Information non disponible | DD.MM.YYYY
    R23D226_CODEBACKOFFICEDES  As String * 1   ' 0103-0104 (001) | '3'                           | Niet beschikbaar bij PFNE | Date de Liquidation | Date de liquidation du contrat Wholesale | Information non disponible | DD.MM.YYYY
    R23A227_DUMMY_259          As String * 131 ' 0104-0233 (131) | Leeg                          | Vullen met x-en | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
End Type


Private Type Record_DetailDuScoring_DetailDuScoring
    R50A001_DE_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
    R50N002_DE_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
    R50N003_DE_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
    R50N004_DE_Code_enreg      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘50’ | Code enregistrement | Constante vaut "23" | Valoriser à '23' | 0
    R50N005_DetailDuScoring    As String * 60  ' 0020-0079 (060) | Scoring                       | Le résultat des différents critères du tableau du scoring VAC-PFNE
    R50A006_DUMMY_501          As String * 154 ' 0080-0233 (154) | Leeg                          | Vullen met x-en | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
End Type


Public Function CreateBaleIIExportFiles(ByVal adat_Date As Date) As String
          Dim FSO As FileSystemObject
          Dim SQL As String
          Dim Rs As ADODB.Recordset
          Dim Res As Long
          Dim rc As Long
          Dim cr As Long
          Dim Rs2 As ADODB.Recordset
          Dim Rs2Cnt As Long
          Dim ClearType As Buffer_Record_Len233
          Dim DateEnd As Date
          Dim DateStartBalanced As Date
          Dim DateStartOffBalanced As Date
    
          Dim RecStr As String
          Dim T01 As Record_01_Demande
          Dim T03 As Record_03_Demande
          Dim T05 As Record_05_Financement_de_Bien
          Dim T06 As Record_06_Financement_de_Bien
          Dim T08 As Record_08_Vehicule
    
          Dim T10_1 As Record_10_Intervenant ' client
          Dim T10_2 As Record_10_Intervenant ' co-client
          Dim T10_3 As Record_10_Intervenant ' warrent
          'Dim T10_4 As Record_10_Intervenant ' role 99, en dan toch maar niet...
    
          Dim T11_1 As Record_11_Particulier ' client
          Dim T11_2 As Record_11_Particulier ' co-client
          Dim T11_3 As Record_11_Particulier ' warrent
          'Dim T11_4 As Record_11_Particulier ' role 99, en dan toch maar niet...
    
          Dim T12_1 As Record_12_Particulier ' client
          Dim T12_2 As Record_12_Particulier ' co-client
          Dim T12_3 As Record_12_Particulier ' warrent
          'Dim T12_4 As Record_12_Particulier ' role 99, en dan toch maar niet...
    
          Dim T13_1 As Record_13_Particulier ' client
          Dim T13_2 As Record_13_Particulier ' co-client
          Dim T13_3 As Record_13_Particulier ' warrent
          'Dim T13_4 As Record_13_Particulier ' role 99, en dan toch maar niet...
    
          Dim T14_1 As Record_14_Particulier ' client
          Dim T14_2 As Record_14_Particulier ' co-client
          Dim T14_3 As Record_14_Particulier ' warrent
          'Dim T14_4 As Record_14_Particulier ' role 99, en dan toch maar niet...
    
          Dim T15 As Record_15_Entreprise
          Dim T16 As Record_16_Decision
    
          Dim T22_1 As Record_22_Palier
          Dim T22_2 As Record_22_Palier
          Dim T23 As Record_23_Bale_II
    
          ' 2nd file record for scoring
          Dim T50 As Record_DetailDuScoring_DetailDuScoring
    
          Dim TS1 As TextStream
          Dim TS2 As TextStream
          Dim Buf As Buffer_Record_Len233
          Dim FNm As String
          Dim FPt As String
    
          Dim IsBalloon As Boolean
          Dim Paliers As Long
    
10        On Error GoTo lbl_Error

20        ClearType.Buffer = String(Len(ClearType.Buffer), " ")

30        DateEnd = LaatsteVanDeMaand(adat_Date) ' 31-1-2011
40        DateStartBalanced = EersteVanDeMaand(adat_Date) ' 1-1-2011
50        DateStartOffBalanced = DateAdd("m", -2, EersteVanDeMaand(adat_Date)) ' 1-11-2010

60        Set FSO = New FileSystemObject
70        FPt = LeesParameter("BALE2INTF")
80        If Right(FPt, 1) <> "\" Then FPt = FPt & "\"
90        FNm = "PFNE_BALEII_" & Format(DateEnd, "yyyyMM")

100       mstr_Status = "Start 1"
    
110       mROL_RTHC = LeesParameter("ROL_RTHC")
120       mROL_RTMC1 = LeesParameter("ROL_RTMC1")
130       mROL_RTMC2 = LeesParameter("ROL_RTMC2")
140       mROL_RTBC1 = LeesParameter("ROL_RTBC1")
150       mROL_RTBC2 = LeesParameter("ROL_RTBC2")
    
160       SQL = ""
170       SQL = SQL & "SELECT " & vbCrLf
180       SQL = SQL & "  AV_ALG.AANVRAAGNR      AS AV_ALG__AANVRAAGNR     , " & vbCrLf
190       SQL = SQL & "  AV_ALG.PCFINETNR       AS AV_ALG__PCFINETNR      , " & vbCrLf
200       SQL = SQL & "  AV_ALG.AANV_DATUM      AS AV_ALG__AANV_DATUM     , " & vbCrLf
210       SQL = SQL & "  AV_ALG.UPL_DATUM       AS AV_ALG__UPL_DATUM      , " & vbCrLf
220       SQL = SQL & "  AV_ALG.CONTRACTNR      AS AV_ALG__CONTRACTNR     , " & vbCrLf
230       SQL = SQL & "  AV_ALG.ACC_DATUM       AS AV_ALG__ACC_DATUM      , " & vbCrLf
240       SQL = SQL & "  AV_ALG.ACCEPTATIE      AS AV_ALG__ACCEPTATIE     , " & vbCrLf
250       SQL = SQL & "  AV_ALG.AANK_DATUM      AS AV_ALG__AANK_DATUM     , " & vbCrLf
260       SQL = SQL & "  AV_ALG.AANGEKOCHT      AS AV_ALG__AANGEKOCHT     , " & vbCrLf
270       SQL = SQL & "  AV_ALG.ANN_DATUM       AS AV_ALG__ANN_DATUM      , " & vbCrLf
280       SQL = SQL & "  AV_ALG.PROD_CODE       AS AV_ALG__PROD_CODE      , " & vbCrLf
290       SQL = SQL & "  AV_ALG.TEK_DATUM       AS AV_ALG__TEK_DATUM      , " & vbCrLf
    
300       SQL = SQL & "  AV_FIN.CON_SOORT       AS AV_FIN__CON_SOORT      , " & vbCrLf
310       SQL = SQL & "  AV_FIN.FIN_BEDRAG      AS AV_FIN__FIN_BEDRAG     , " & vbCrLf
320       SQL = SQL & "  AV_FIN.AANBETAL        AS AV_FIN__AANBETAL       , " & vbCrLf
330       SQL = SQL & "  AV_FIN.VERGOEDING      AS AV_FIN__VERGOEDING     , " & vbCrLf
340       SQL = SQL & "  AV_FIN.HERFIN_BED      AS AV_FIN__HERFIN_BED     , " & vbCrLf
350       SQL = SQL & "  AV_FIN.LOOPTIJD        AS AV_FIN__LOOPTIJD       , " & vbCrLf
360       SQL = SQL & "  AV_FIN.INTEREST        AS AV_FIN__INTEREST       , " & vbCrLf
370       SQL = SQL & "  AV_FIN.BEGINDATUM      AS AV_FIN__BEGINDATUM     , " & vbCrLf
380       SQL = SQL & "  AV_FIN.EINDDATUM       AS AV_FIN__EINDDATUM      , " & vbCrLf
390       SQL = SQL & "  AV_FIN.TERMIJN         AS AV_FIN__TERMIJN        , " & vbCrLf
400       SQL = SQL & "  AV_FIN.RESTANT         AS AV_FIN__RESTANT        , " & vbCrLf
410       SQL = SQL & "  AV_FIN.RESTANTBET      AS AV_FIN__RESTANTBET     , " & vbCrLf
420       SQL = SQL & "  AV_FIN.VERKPRIJS       AS AV_FIN__VERKPRIJS      , " & vbCrLf
    
430       SQL = SQL & "  AV_AANK.INCASSO        AS AV_AANK__INCASSO       , " & vbCrLf
    
440       SQL = SQL & "  AV_OBJ.CATEGORIE       AS AV_OBJ__CATEGORIE      , " & vbCrLf
450       SQL = SQL & "  AV_OBJ.BOUWJAAR        AS AV_OBJ__BOUWJAAR       , " & vbCrLf
460       SQL = SQL & "  AV_OBJ.SOORTAUTO       AS AV_OBJ__SOORTAUTO      , " & vbCrLf
    
470       SQL = SQL & "  AV_SCORE.ZEKERHEDEN    AS AV_SCORE__ZEKERHEDEN   , " & vbCrLf
480       SQL = SQL & "  AV_SCORE.KLASSE        AS AV_SCORE__KLASSE       , " & vbCrLf
490       SQL = SQL & "  AV_SCORE.SCORE         AS AV_SCORE__SCORE        , " & vbCrLf
500       SQL = SQL & "  AV_SCORE.BKRSCORE      AS AV_SCORE__BKRSCORE     , " & vbCrLf
510       SQL = SQL & "  AV_SCORE.AVSTATUS      AS AV_SCORE__AVSTATUS     , " & vbCrLf
520       SQL = SQL & "  AV_SCORE.AANTBKRCONTR  AS AV_SCORE__AANTBKRCONTR , " & vbCrLf
530       SQL = SQL & "  AV_SCORE.AANTINKOMEN   AS AV_SCORE__AANTINKOMEN  , " & vbCrLf

540       SQL = SQL & "  0 AS DUMMY " & vbCrLf
550       SQL = SQL & "FROM " & vbCrLf
560       SQL = SQL & "    AV_ALG " & vbCrLf
570       SQL = SQL & "        LEFT JOIN AV_FIN    ON AV_FIN.AANVRAAGNR    = AV_ALG.AANVRAAGNR " & vbCrLf
580       SQL = SQL & "        LEFT JOIN AV_AANK   ON AV_AANK.AANVRAAGNR   = AV_ALG.AANVRAAGNR " & vbCrLf
590       SQL = SQL & "        LEFT JOIN AV_OBJ    ON AV_OBJ.AANVRAAGNR    = AV_ALG.AANVRAAGNR " & vbCrLf
600       SQL = SQL & "        LEFT JOIN AV_SCORE  ON AV_SCORE.AANVRAAGNR  = AV_ALG.AANVRAAGNR " & vbCrLf
610       SQL = SQL & "WHERE " & vbCrLf
          'DateEnd = LaatsteVanDeMaand(adat_Date) ' 31-1-2011
          'DateStartBalanced = EersteVanDeMaand(adat_Date) ' 1-1-2011
          'DateStartOffBalanced = DateAdd("m", -2, EersteVanDeMaand(adat_Date)) ' 1-11-2010
          '110704 Proovit/EH: show all balanced demands and all off-balance demands
          'balanced demands: activated(=send to GVAC=AANGEKOCHT) in last month
          'off-balanced demands: Accepted in last 3 months + not activated(=send to GVAC=AANGEKOCHT) + not refused(=accepted=GEACCEPTEERD)
    
          'Balanced demands last month: (DateStartBalanced-DateEnd)
620       SQL = SQL & "  ( (NVL(AV_ALG.AANGEKOCHT,0) = 1) AND (AV_ALG.AANK_DATUM >= " & ORADate2SQL(DateStartBalanced) & " AND AV_ALG.AANK_DATUM <= " & ORADate2SQL(DateEnd) & ") )" & vbCrLf
          ' and...
630       SQL = SQL & "  OR " & vbCrLf
          'Off-balanced demands last 3 months: (DateStartOffBalanced-DateEnd)
640       SQL = SQL & "  ( (NVL(AV_ALG.AANGEKOCHT,0) <> 1) AND (NVL(AV_ALG.ACCEPTATIE,'')='J') AND (AV_ALG.ACC_DATUM >= " & ORADate2SQL(DateStartOffBalanced) & " AND AV_ALG.ACC_DATUM <= " & ORADate2SQL(DateEnd) & ") )" & vbCrLf

          ' Voor test!
      '    If InVbIDE() Then
      '        Debug.Assert False '000010781000041
      '        SQL = SQL & "  AND AV_ALG.PCFINETNR = '10781000041' "
      '    End If
  
    
650     mstr_Status = "Start 2"
    
660       Call SetInfoText("Openen te exporteren data...", aUseBusyMeter:=True)
670       Res = AppCn.OpenRs(Rs, SQL, True, , , , True)
680       If Res > 0 Then
690           Call Rs.MoveLast
700           Call Rs.MoveFirst
710           cr = 0
720           rc = Rs.RecordCount
730           Set TS1 = FSO.CreateTextFile(FPt & FNm & ".txt", True)
740           Set TS2 = FSO.CreateTextFile(FPt & FNm & "_SCORE.txt", True)
  
750           Do While Not Rs.BOF And Not Rs.EOF
760               cr = cr + 1
    
770               mstr_Status = "Verwerk aanvraagnr '" & Rs!AV_ALG__AANVRAAGNR & "'"
780               If Not IsNumeric(Trim(Rs!AV_ALG__PCFINETNR & "")) Then
                      ' Empty pcfinetnr... create
790                   mstr_PCFINETNR = CreateField(15, CLng(Trim(Rs!AV_ALG__AANVRAAGNR & "")), True, "8")
800               Else
810                   mstr_PCFINETNR = Trim(Rs!AV_ALG__PCFINETNR & "")
820               End If
830               T01 = Record_01_Demande(Rs):             If mbln_SkipRecord Then GoTo lbl_SkipRecord
840               T03 = Record_03_Demande(Rs):             If mbln_SkipRecord Then GoTo lbl_SkipRecord
                  ' Record 5 is created after 22...
850               T06 = Record_06_Financement_de_Bien(Rs): If mbln_SkipRecord Then GoTo lbl_SkipRecord
860               T08 = Record_08_Vehicule(Rs):            If mbln_SkipRecord Then GoTo lbl_SkipRecord
    
870               LSet T10_1 = ClearType
880               LSet T11_1 = ClearType
890               LSet T12_1 = ClearType
900               LSet T13_1 = ClearType
910               LSet T14_1 = ClearType
920               LSet T10_2 = ClearType
930               LSet T11_2 = ClearType
940               LSet T12_2 = ClearType
950               LSet T13_2 = ClearType
960               LSet T14_2 = ClearType
970               LSet T10_3 = ClearType
980               LSet T11_3 = ClearType
990               LSet T12_3 = ClearType
1000              LSet T13_3 = ClearType
1010              LSet T14_3 = ClearType
                  'LSet T10_4 = ClearType ' ivm rol=99 , en dan toch maar niet...
                  'LSet T11_4 = ClearType ' ivm rol=99 , en dan toch maar niet...
                  'LSet T12_4 = ClearType ' ivm rol=99 , en dan toch maar niet...
                  'LSet T13_4 = ClearType ' ivm rol=99 , en dan toch maar niet...
                  'LSet T14_4 = ClearType ' ivm rol=99 , en dan toch maar niet...
1020              LSet T15 = ClearType
   
                  Dim CRS As ADODB.Recordset
1030              If AppCn.GetFieldValueBySQL("SELECT Count(AANVRAAGNR) FROM BEDRIJF WHERE AANVRAAGNR = '" & Rs!AV_ALG__AANVRAAGNR & "'", 0) > 0 Then
                      ' Business,so only a record 15
1040                  Res = AppCn.OpenRs(CRS, "SELECT * FROM QRY_BED_HOOFDCONTRACTANTEN WHERE AANVRAAGNR='" & Rs!AV_ALG__AANVRAAGNR & "'", True)
1050                  If Res = 1 Then
1060                      Debug.Print mstr_PCFINETNR
    
1070                      T10_1 = Record_10_Intervenant(Rs, 1)
1080                      T15 = Record_15_Entreprise(Rs, CRS)
  
                          ' een dummy voor interne perikelen in FR met rol = 99 (jul 2010)
                          ' en dan toch maar niet... (aug 2010)
                          'T10_4 = Record_10_Intervenant(Rs, 99)
                          'T11_4 = Record_11_Particulier(Rs, CRS)
                          'T12_4 = Record_12_Particulier(Rs, CRS)
                          'T13_4 = Record_13_Particulier(Rs, CRS)
                          'T14_4 = Record_14_Particulier(Rs, CRS)
  
1090                  ElseIf Res > 1 Then
1100                      Debug.Assert False
1110                      Call Err.Raise(vbObjectError, "PCRETAIL.INTF_BaleII_Module.CreateBaleIIExportFiles", "ERROR 1002152336: Creating record 15 for demand '" & Rs!AV_ALG__AANVRAAGNR & " resulted in more than one leading contracter. Demand was skipped completely.")
1120                      GoTo lbl_SkipRecord
1130                  ElseIf Res = 0 Then
1140                      Debug.Assert False
1150                      Call Err.Raise(vbObjectError, "PCRETAIL.INTF_BaleII_Module.CreateBaleIIExportFiles", "ERROR 1002152337: Creating record 15 for demand '" & Rs!AV_ALG__AANVRAAGNR & " resulted in NO leading contracter. Demand was skipped completely.")
1160                      GoTo lbl_SkipRecord
1170                  Else
1180                      Debug.Assert False
1190                      Call Err.Raise(vbObjectError, "PCRETAIL.INTF_BaleII_Module.CreateBaleIIExportFiles", "ERROR 1002152338: Creating record 15 for demand '" & Rs!AV_ALG__AANVRAAGNR & " resulted in errors while retrieving leading contracter. Demand was skipped completely.")
1200                      GoTo lbl_SkipRecord
1210                  End If

                      ' Borg contractant voor bedrijven
1220                  Res = AppCn.OpenRs(CRS, "SELECT * FROM AV_BORG WHERE AANVRAAGNR='" & Rs!AV_ALG__AANVRAAGNR & "' AND (Rol = '" & mROL_RTBC1 & "' OR Rol = '" & mROL_RTBC2 & "')", False)
1230                  If Res = 1 Then
                          ' Create records
1240                      T10_2 = Record_10_Intervenant(Rs, 2)
1250                      T11_2 = Record_11_Particulier(Rs, CRS)
1260                      T12_2 = Record_12_Particulier(Rs, CRS)
1270                      T13_2 = Record_13_Particulier(Rs, CRS)
1280                      T14_2 = Record_14_Particulier(Rs, CRS)
1290                  ElseIf Res > 1 Then
1300                      mstr_ErrLog = mstr_ErrLog & "WARING #1007131201 There are more than 1 'borg' contractors found for demand '" & Rs!AV_ALG__AANVRAAGNR & "'" & vbCrLf
1310                      Debug.Assert False
1320                  End If

1330              Else
                      ' person ,so record 11, 12, 13 and 14

                      ' Hoofd contractant
1340                  Res = AppCn.OpenRs(CRS, "SELECT * FROM RELATIE WHERE AANVRAAGNR='" & Rs!AV_ALG__AANVRAAGNR & "' AND Rol = '" & mROL_RTHC & "'", False)
1350                  If Rs Is Nothing Then
1360                      Debug.Assert False
1370                      Call Err.Raise(vbObjectError, "PCRETAIL.INTF_BaleII_Module.CreateBaleIIExportFiles", "ERROR 1003162339: Creating records 10,11,12,13,14 for demand '" & Rs!AV_ALG__AANVRAAGNR & " resulted in NO contracters. Demand was skipped completely.")
1380                      GoTo lbl_SkipRecord
1390                  ElseIf Res > 0 Then
1400                      If Res > 1 Then
1410                          Debug.Assert False
1420                          Call Err.Raise(vbObjectError, "PCRETAIL.INTF_BaleII_Module.CreateBaleIIExportFiles", "ALERT 1002152339: Creating records 10,11,12,13,14 for demand '" & Rs!AV_ALG__AANVRAAGNR & " resulted in NO contracters. Demand was skipped completely.")
1430                          GoTo lbl_SkipRecord
1440                      End If
                          ' Create recs for role = 1 = main private contractor
1450                      T10_1 = Record_10_Intervenant(Rs, 1)
1460                      T11_1 = Record_11_Particulier(Rs, CRS)
1470                      T12_1 = Record_12_Particulier(Rs, CRS)
1480                      T13_1 = Record_13_Particulier(Rs, CRS)
1490                      T14_1 = Record_14_Particulier(Rs, CRS)
  
                          ' Create dummy recs for FR with role = 99 (jul 2010)
                          ' en dan toch maar niet... (aug 2010)
                          'T10_4 = Record_10_Intervenant(Rs, 99)
                          'T15 = Record_15_Entreprise(Rs, CRS)
    
1500                  ElseIf Res = 0 Then
1510                      Debug.Assert False
1520                      Call Err.Raise(vbObjectError, "PCRETAIL.INTF_BaleII_Module.CreateBaleIIExportFiles", "ERROR 1002152339: Creating records 10,11,12,13,14 for demand '" & Rs!AV_ALG__AANVRAAGNR & " resulted in NO contracters. Demand was skipped completely.")
1530                      GoTo lbl_SkipRecord
1540                  Else
1550                      Debug.Assert False
1560                      Call Err.Raise(vbObjectError, "PCRETAIL.INTF_BaleII_Module.CreateBaleIIExportFiles", "ERROR 1002152340: Creating record 10,11,12,13,14 for demand '" & Rs!AV_ALG__AANVRAAGNR & " resulted in errors while retrieving contracters. Demand was skipped completely.")
1570                      GoTo lbl_SkipRecord
1580                  End If

                      ' Mede contractant
1590                  Res = AppCn.OpenRs(CRS, "SELECT * FROM RELATIE WHERE AANVRAAGNR='" & Rs!AV_ALG__AANVRAAGNR & "' AND (Rol = '" & mROL_RTMC1 & "' OR Rol = '" & mROL_RTMC2 & "')", False)
1600                  If Res = 1 Then
                          ' Create records
1610                      T10_3 = Record_10_Intervenant(Rs, 3)
1620                      T11_3 = Record_11_Particulier(Rs, CRS)
1630                      T12_3 = Record_12_Particulier(Rs, CRS)
1640                      T13_3 = Record_13_Particulier(Rs, CRS)
1650                      T14_3 = Record_14_Particulier(Rs, CRS)
1660                  ElseIf Res > 1 Then
1670                      mstr_ErrLog = mstr_ErrLog & "WARING #100425058202 There are more than 1 'co' contractors found for demand '" & Rs!AV_ALG__AANVRAAGNR & "'" & vbCrLf
1680                      Debug.Assert False
1690                  End If

                      ' Borg contractant
1700                  Res = AppCn.OpenRs(CRS, "SELECT * FROM AV_BORG WHERE AANVRAAGNR='" & Rs!AV_ALG__AANVRAAGNR & "' AND (Rol = '" & mROL_RTBC1 & "' OR Rol = '" & mROL_RTBC2 & "')", False)
1710                  If Res = 1 Then
                          ' Create records
1720                      T10_2 = Record_10_Intervenant(Rs, 2)
1730                      T11_2 = Record_11_Particulier(Rs, CRS)
1740                      T12_2 = Record_12_Particulier(Rs, CRS)
1750                      T13_2 = Record_13_Particulier(Rs, CRS)
1760                      T14_2 = Record_14_Particulier(Rs, CRS)
1770                  ElseIf Res > 1 Then
1780                      mstr_ErrLog = mstr_ErrLog & "WARING #100425058201 There are more than 1 'borg' contractors found for demand '" & Rs!AV_ALG__AANVRAAGNR & "'" & vbCrLf
1790                      Debug.Assert False
1800                  End If
  
  
  
1810              End If ' is bedrijf Else ' person ,so record 11, 12, 13 and 14
  
1820              T16 = Record_16_Decision(Rs):      If mbln_SkipRecord Then GoTo lbl_SkipRecord
  
1830              IsBalloon = GetSaveNumber(Trim(Rs!AV_FIN__RESTANTBET & "")) > 0
                  ' When Balloon  or  UB  Then 2 Palliers
1840              If IsBalloon Or (GetSaveNumber(Trim(Rs!AV_FIN__LOOPTIJD & "")) = 0) Then Paliers = 2 Else Paliers = 1

                  ' A field in rec 5 is depending on Balloon/palliers
1850              T05 = Record_05_Financement_de_Bien(Rs, Paliers): If mbln_SkipRecord Then GoTo lbl_SkipRecord

1860              If (Paliers = 1) Then ' normal rec
1870                  T22_1 = Record_22_Palier(Rs, False, 1)
1880                  T22_2.R22A199_PL_CD_FILIALE = "" ' clear rec 22_2
1890              Else ' balloon
1900                  T22_1 = Record_22_Palier(Rs, True, 1)
1910                  T22_2 = Record_22_Palier(Rs, True, 2)
1920              End If
1930              T23 = Record_23_Bale_II(Rs)

1940              If mbln_SkipRecord Then GoTo lbl_SkipRecord

                  ' Write to buffer rec , and then buffer rec to file
1950              LSet Buf = T01:   Call TS1.WriteLine(Buf.Buffer)
1960              LSet Buf = T03:   Call TS1.WriteLine(Buf.Buffer)
1970              LSet Buf = T05:   Call TS1.WriteLine(Buf.Buffer)
1980              LSet Buf = T06:   Call TS1.WriteLine(Buf.Buffer)
1990              LSet Buf = T08:   Call TS1.WriteLine(Buf.Buffer)

2000              If Trim(T15.R15A172_EN_CD_FILIALE) <> "" Then  ' company
2010                  Debug.Print mstr_PCFINETNR
2020                  LSet Buf = T10_1: Call TS1.WriteLine(Buf.Buffer)
2030                  LSet Buf = T15: Call TS1.WriteLine(Buf.Buffer)
2040                  If Trim(T10_2.R10A090_IN_CD_FILIALE) <> "" Then  ' borg
'36500                     Debug.Assert False
2050                      LSet Buf = T10_2: Call TS1.WriteLine(Buf.Buffer)
2060                      LSet Buf = T11_2: Call TS1.WriteLine(Buf.Buffer)
2070                      LSet Buf = T12_2: Call TS1.WriteLine(Buf.Buffer)
2080                      LSet Buf = T13_2: Call TS1.WriteLine(Buf.Buffer)
2090                      LSet Buf = T14_2: Call TS1.WriteLine(Buf.Buffer)
2100                  End If
                      ' Dummy record with roll = 99. containing personal data owner (not known...) recs 10, 11, 12, 13, 14 (jul 2010)
                      ' en dan toch maar niet... (aug 2010)
                      'LSet Buf = T10_4: Call TS1.WriteLine(Buf.Buffer)
                      'LSet Buf = T11_4: Call TS1.WriteLine(Buf.Buffer)
                      'LSet Buf = T12_4: Call TS1.WriteLine(Buf.Buffer)
                      'LSet Buf = T13_4: Call TS1.WriteLine(Buf.Buffer)
                      'LSet Buf = T14_4: Call TS1.WriteLine(Buf.Buffer)
    
2110              Else ' prive
                      ' Main contracter data 10, 11, 12, 13, 14
2120                  LSet Buf = T10_1: Call TS1.WriteLine(Buf.Buffer)
2130                  LSet Buf = T11_1: Call TS1.WriteLine(Buf.Buffer)
2140                  LSet Buf = T12_1: Call TS1.WriteLine(Buf.Buffer)
2150                  LSet Buf = T13_1: Call TS1.WriteLine(Buf.Buffer)
2160                  LSet Buf = T14_1: Call TS1.WriteLine(Buf.Buffer)

                      ' Main warent/garant data 10, 11, 12, 13, 14
2170                  If Trim(T10_2.R10A090_IN_CD_FILIALE) <> "" Then
2180                      LSet Buf = T10_2: Call TS1.WriteLine(Buf.Buffer)
2190                      LSet Buf = T11_2: Call TS1.WriteLine(Buf.Buffer)
2200                      LSet Buf = T12_2: Call TS1.WriteLine(Buf.Buffer)
2210                      LSet Buf = T13_2: Call TS1.WriteLine(Buf.Buffer)
2220                      LSet Buf = T14_2: Call TS1.WriteLine(Buf.Buffer)
2230                  End If

                      ' Main co-contracter data 10, 11, 12, 13, 14
2240                  If Trim(T10_3.R10A090_IN_CD_FILIALE) <> "" Then
2250                      LSet Buf = T10_3: Call TS1.WriteLine(Buf.Buffer)
2260                      LSet Buf = T11_3: Call TS1.WriteLine(Buf.Buffer)
2270                      LSet Buf = T12_3: Call TS1.WriteLine(Buf.Buffer)
2280                      LSet Buf = T13_3: Call TS1.WriteLine(Buf.Buffer)
2290                      LSet Buf = T14_3: Call TS1.WriteLine(Buf.Buffer)
2300                  End If
    
                      ' Dummy record containing company data owner (that is not known...) recs 10, 11, 12, 13, 14. weird stuff, but the like it! (jul 2010)
                      ' en dan toch maar niet... (aug 2010)
                      'LSet Buf = T10_4: Call TS1.WriteLine(Buf.Buffer)
                      'LSet Buf = T15: Call TS1.WriteLine(Buf.Buffer)
    
2310              End If
2320              LSet Buf = T16: Call TS1.WriteLine(Buf.Buffer)

2330              LSet Buf = T22_1: Call TS1.WriteLine(Buf.Buffer)
2340              If T22_2.R22A199_PL_CD_FILIALE = "N" Then LSet Buf = T22_2: Call TS1.WriteLine(Buf.Buffer) ' write only when not empty
2350              LSet Buf = T23: Call TS1.WriteLine(Buf.Buffer)

                  ' Rec 50, to 2nd file
2360              If AppCn.OpenRs(Rs2, "SELECT REG_CODE, COND_NR, COND_SCORE, AFWIJS_REG_CODE, ZEKERH_CODE, INFO_REG_CODE FROM AV_SCOREDETAIL WHERE PCFINETNR = '" & mstr_PCFINETNR & "'", True, , , , True) > 0 Then
2370                  Call Rs2.MoveFirst
2380                  Rs2Cnt = 0
2390                  Do While Not Rs2.EOF Or Rs2.BOF
2400                      Rs2Cnt = Rs2Cnt + 1 ' volgnr
2410                      T50 = Record_DetailDuScoring_DetailDuScoring(Rs2, Rs2Cnt)
2420                      LSet Buf = T50: Call TS2.WriteLine(Buf.Buffer)
2430                      Call Rs2.MoveNext
2440                  Loop
2450              End If

  
lbl_SkipRecord:
2460              mbln_SkipRecord = False
                  ' Next demande
2470              Call Rs.MoveNext
2480              If cr Mod 5 = 0 Then Call SetInfoText(IIf(AutoPilot, "Automatische verwerking. ", "") & "Exporteren " & Format(rc, "#,##0") & " records (" & Format((cr / rc) * 100, "0.000") & "%) ...", True, rc, cr)
2490          Loop
2500          Call TS1.Close
2510          Call TS2.Close
2520          CreateBaleIIExportFiles = "OK"
2530          If Not AutoPilot Then Call MsgBox("Klaar met exporteren", vbInformation)
  
2540      ElseIf Res = 0 Then
2550          CreateBaleIIExportFiles = "NO RECS"
2560          mstr_ErrLog = mstr_ErrLog & "Error #1003271624 There where no records found. " & vbCrLf
2570          If Not AutoPilot Then Call MsgBox("De selectie leverde geen resultaat op om te exporteren", vbExclamation)
2580          Debug.Assert False
2590      Else
2600          CreateBaleIIExportFiles = "ERROR"
2610          mstr_ErrLog = mstr_ErrLog & "Error #1003271625 There where errors opening selection. " & vbCrLf
2620          If Not AutoPilot Then Call MsgBox("De selectie leverde fouten op; exporteren gestopt.", vbCritical)
2630          Debug.Assert False
2640      End If

2650      If Trim(mstr_ErrLog) <> "" Then
2660          On Error GoTo lbl_Exit
2670          Set TS1 = Nothing
2680          Set TS1 = FSO.CreateTextFile(FPt & FNm & ".log", True)
2690          Call TS1.Write(mstr_ErrLog)
2700          Call TS1.Close
2710          mstr_ErrLog = ""
2720      End If


lbl_Exit:
2730      Set FSO = Nothing
2740      Call SetInfoText
2750      Exit Function

lbl_Error:
2760      Debug.Assert False
2770      If HandleSilantError(Err.Number, "Module: zBaselII", "CreateBaleIIExportFiles - Status: " & mstr_Status, Err.Description & " [" & UserID & "]") = 1 Then
2780          GoTo lbl_Exit
2790      Else
2800          Resume Next
2810      End If

End Function





Private Function Record_01_Demande(aRs As ADODB.Recordset) As Record_01_Demande
          Dim t As Record_01_Demande
    
          ' R01A001_DE_CD_FILIALE As String * 1   ' 0001-0001 (001) | Filiaal code         | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
10        On Error GoTo lbl_Error

20        t.R01A001_DE_CD_FILIALE = "N"
          ' R01N002_DE_CD_SYSSRCE As String * 1   ' 0002-0002 (001) | Bron nummer          | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
30        t.R01N002_DE_CD_SYSSRCE = "1"
          ' R01A003_DE_NO_DEMANDE As String * 15  ' 0003-0017 (015) | Aanvraagnummer       | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | correction 11-12-2009: justifié à droite (rechts), complété par des zéros à gauche (left)
40        t.R01A003_DE_NO_DEMANDE = CreateField(15, mstr_PCFINETNR, True, "0")
          ' R01N004_DE_CODE_ENREG As String * 2   ' 0018-0019 (002) | Recordnummer         | Constante: ‘01’ | Code enregistrement | Constante vaut "01" | Valoriser à '01' | 0
50        t.R01N004_DE_CODE_ENREG = "01"
    
          ' R01N005_DE_NO_CD_CLE As String * 15  ' 0020-0034 (015) | Aanvraagnummer       | PCRetail DB - AV_ALG . PCFINETNR | Numéro de demande | Numéro de demande (DE_NO_CD_CLE) | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
60        t.R01N005_DE_NO_CD_CLE = CreateField(15, mstr_PCFINETNR, True, "0")
          ' R01A006_BLANC_39 As String * 91  ' 0035-0125 (091) | Leeg                 | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
70        t.R01A006_BLANC_39 = Space(91)
          ' R01D007_DE_DT_DEMANDE As String * 10  ' 0126-0135 (010) | Aanvraag datum       | PCRetail DB - AV_ALG . AANV_DATUM | Date de la demande | "Date d'enregistrement de la demande dans le système de gestion provisoire Si la date est absente, mettre 01.01.1801" | PCRetail - AV_ALG / AANV_DATUM | DD.MM.YYYY
80        t.R01D007_DE_DT_DEMANDE = CreateDate(aRs!AV_ALG__AANV_DATUM)
          ' R01A008_BLANC_41 As String * 1   ' 0136-0136 (001) | Leeg                 | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
90        t.R01A008_BLANC_41 = Space(1)
          ' R01D009_DE_DT_DERMODIF As String * 10  ' 0137-0146 (010) | Upload datum         | PCRetail DB - AV_ALG / UPL_DATUM | Date de dernière modification | Date de la dernière mise à jour des informations de la demande dans le système de gestion provisoire | PCRetail - AV_ALG / UPL_DATUM ??? À vérifier | DD.MM.YYYY
100       t.R01D009_DE_DT_DERMODIF = CreateDate(aRs!AV_ALG__UPL_DATUM)
          ' R01A010_DE_CD_SUCCUR As String * 6   ' 0147-0152 (006) | Filiaal              | Constante: ‘PFNE’ | Code de la succursale | "Identifiant de la succursale commerciale dans laquelle a été effectuée la demande Exemple : Dans le cas de la France, les succursales sont : * Crédipar (pour les techniques de financement PP - VAC - LOA - CPA) * Locadin (techniques VAC - LOA) * SLV (techniques LLD - LOA - CB)" | Pour la Hollande, valoriser à 'PFNE' | justifié à gauche (left), complété par des blancs à droite (rechts)
110       t.R01A010_DE_CD_SUCCUR = "PFNE"
    
          'R01A011_DE_CD_FAMPROD As String * 3   ' 0153-0155 (003) | Product type         | PCRetail Functie: indien restant betaling aanwezig dan = balloon (4), Indien product = PL dan prêt personnel (6) anders = VAC (1) | Famille de produit financier | "La famille de produit financier : 0 : Non renseigné / Indéterminé 1 : VAC 2 : Leasing 3 : LLD 4 : Produit Ballon 5 : Autres 6 : Prêts Personnels 7 : Services Seuls" | "PCRetail - indien restant betaling aanwezig dan = balloon (4) /// Indien product = PL dan prêt personnel (6) /// anders = VAC (1) if restant betaling is present then = balloon (4) /// if product = PL then prêt personnel (6) /// else = VAC (1) - valoriser le champ à 1 - Si présence de VAC ballon, valoriser le champ à 4" | justifié à gauche (left), complété par des blancs à droite (rechts)
120       If GetSaveNumber(aRs!AV_FIN__RESTANTBET) > 0 Then
130           t.R01A011_DE_CD_FAMPROD = "4" ' balloon (4)
140       ElseIf Trim(aRs!AV_FIN__CON_SOORT & "") = "PL" Then
150           t.R01A011_DE_CD_FAMPROD = "6" ' product = PL dan prêt personnel (6)
160       Else
170           t.R01A011_DE_CD_FAMPROD = "1" ' anders = VAC(1)
180       End If
          ' R01A012_DE_NO_CONTRAT As String * 15  ' 0156-0170 (015) | Contractnummer       | PCRetail DB - AV_ALG . CONTRACTNR | Numéro de contrat | "Numéro de contrat Ce numéro de contrat sert de clé entre le fichier des demandes et le fichier des contrats. Il doit donc être identique entre la gestion provisoire et la gestion définitive" | PCRetail - AV_ALG / CONTRACTNR | justifié à gauche (left), complété par des blancs à droite (rechts)
          ' 110704 Proovit/EH: Evolution Bale 2 june 2011: balanced and off-balanced...
190       If GetSaveNumber(aRs!AV_ALG__AANGEKOCHT) = 1 Then 'balanced demand
200           t.R01A012_DE_NO_CONTRAT = CreateField(15, aRs!AV_ALG__CONTRACTNR & "")
210       Else ' off-balanced demand
220           t.R01A012_DE_NO_CONTRAT = CreateField(15, aRs!AV_ALG__PCFINETNR & "")
230       End If
    
          ' R01A013_BLANC_46 As String * 30  ' 0171-0200 (030) | Leeg                 | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
240       t.R01A013_BLANC_46 = Space(30)
          ' R01A014_DE_CD_DEVISO As String * 3   ' 0201-0203 (003) | Valuta               | Constante: ‘EUR’ | Code Devise ISO | Code ISO de la devise du dossier sur 3 caractères | = EUR | code ISO de la devise à intégrer dans la V2,0
250       t.R01A014_DE_CD_DEVISO = "EUR"
          ' R01A015_BLANC_48 As String * 3   ' 0204-0206 (003) | Leeg                 | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
260       t.R01A015_BLANC_48 = Space(3)
          ' R01D016_DE_DT_INHORSB As String * 10  ' 0207-0216 (010) | Acceptatie datum     | PCRetail DB - AV_ALG . ACC_DATUM | Date d'entrée en hors bilan | Date d'entrée du dossier dans le portefeuille hors bilan | PCRetail - AV_ALG / ACC_DATUM ??? à vérifier | DD.MM.YYYY
270       t.R01D016_DE_DT_INHORSB = CreateField(10, CreateDate(aRs!AV_ALG__ACC_DATUM), , " ")
          ' R01D017_DE_DT_OUTHORSB As String * 10  ' 0217-0226 (010) | Aankoop datum        | PCRetail DB - AV_ALG . AANK_DATUM | Date de sortie du Hors Bilan | Date de sortie du dossier du portefeuille hors bilan | PCRetail - AV_ALG / AANK_DATUM | DD.MM.YYYY
280       t.R01D017_DE_DT_OUTHORSB = CreateDate(aRs!AV_ALG__AANK_DATUM)
   
          'R01N018_DE_CD_HORSB As String * 1   ' 0227-0227 (001) | Indicator Hors Bilan | Indien selectie criteria = hors bilan dan 1 (indien geaccepteerd maar nog niet aangekocht), Indien aanvraag geannuleerd (AV_ALG . ANN_DATUM) dan 0 | Indicateur Hors bilan | "* Renseignée pour les dossiers en Hors Bilan Uniquement. * Valeurs attendues: - vide pour les dossiers du bilan - 1 = Dossier hors bilan - 2 = Dossier en attente d'entrée en Chiffre d'Affaire - 0 = Dossier sorti du portefeuille hors bilan " | "1 indien selectie criteria hors bilan = indien geaccepteerd maar nog niet aangekocht 1 if corresponding selection criteria hors bilan = if demand accepted but not yet purchased 0 indien aanvraag geannuleerd is AV_ALG / ANN_DATUM" | 0
290       If IsDate(aRs!AV_ALG__ANN_DATUM) Then
300           t.R01N018_DE_CD_HORSB = "0"
310       ElseIf GetSaveNumber(aRs!AV_ALG__AANGEKOCHT) = 0 And Trim(aRs!AV_ALG__ACCEPTATIE & "") = "J" Then
320           t.R01N018_DE_CD_HORSB = "1" ' hors bilan
330       Else
340           t.R01N018_DE_CD_HORSB = "0" ' bilan 100517-PROOVIT-EH: Off-balance indicator o of 1 op verzoek MB
350       End If
    
          ' R01N019_DE_CD_MOTIFOUTHRSB As String * 1   ' 0228-0228 (001) | Type aanvraag        | Niet beschikbaar bij PFNE | Motif de sortie du hors bilan | Motif de sortie du dossier du portefeuille hors bilan. | Information non disponible | 0
360       t.R01N019_DE_CD_MOTIFOUTHRSB = " "
          ' R01A020_SUIG  as String * 4                 0230-0233 (004) | Code SUIG                     | 110704: new code SUIG
'34370     If GetSaveNumber(aRs!AV_ALG__AANGEKOCHT) = 1 Then 'balanced demand
'34380         t.R01A020_SUIG = CreateField(5, " 0933", True)
'34390     Else ' off-balanced demand
'34400         t.R01A020_SUIG = CreateField(5, "XXXXX")
'34410     End If
    
    
          Dim str_CompanyCode As String
370       str_CompanyCode = LeesParameter("COMPCODE") ' PSA Company code. Changed in 2015 from 933 to 993
380       t.R01A020_SUIG = CreateField(5, str_CompanyCode, True)
    
390       Record_01_Demande = t

lbl_Exit:
400       Exit Function

lbl_Error:
410       Debug.Assert False
420       If HandleSilantError(Err.Number, "Module: INTF_BaleII_Module", "Record_01_Demande - Status: " & mstr_Status, Err.Description & " [" & UserID & "]") = 1 Then
430           GoTo lbl_Exit
440       Else
450           Resume Next
460       End If
End Function



Private Function Record_03_Demande(aRs As ADODB.Recordset) As Record_03_Demande
          Dim t As Record_03_Demande
    
          ' R03A021_DE_CD_FILIALE As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
10        On Error GoTo lbl_Error

20        t.R03A021_DE_CD_FILIALE = "N"
          ' R03N022_DE_CD_SYSSRCE As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
30        t.R03N022_DE_CD_SYSSRCE = "1"
          ' R03N023_DE_NO_DEMANDE As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PC-Retail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
40        t.R03N023_DE_NO_DEMANDE = CreateField(15, mstr_PCFINETNR, True, "0")
          ' R03N024_DE_CODE_ENREG As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘03’ | Code enregistrement | Constante vaut "03" | Valoriser à '03' | 0
50        t.R03N024_DE_CODE_ENREG = "03"
 
    
          ' R03A025_BLANC_58 As String * 134 ' 0020-0153 (134) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
60        t.R03A025_BLANC_58 = CreateField(134, "")
          ' R03A026_DE_CD_MOYPMT As String * 6   ' 0154-0159 (006) | Betaal soort                  | PCRetail DB - AV_AANK . INCASSO dan 1 Anders 2 (= bank) | Code moyen de paiement | "Identifiant du type de paiement 0 : Non-renseigné / Indeterminé 1 : Prélèvement Automatique (SF) 2 : Virement bancaire (client) 3 : Chèque 4 : Bulletin postal 5 : Autres" | "PCRetail - AV_AANK / INCASSO 1 = automatische incasso /// 2 = rest 1 = prélèvement automatique /// 2 = others" | justifié à gauche (left), complété par des blancs à droite (rechts)
70        If Trim(aRs!AV_AANK__INCASSO & "") = "J" Then
80            t.R03A026_DE_CD_MOYPMT = "1"
90        Else
100           t.R03A026_DE_CD_MOYPMT = "2"
110       End If
    
          ' R03N027_DE_NB_GARANT As String * 3   ' 0160-0162 (003) | Aantal gekoppelde contactanten| 0-2. Zowel medecontractant als borg contracten tellen elk voor 1. Vaststellen borg: borg is een vd zekerheden | Nombre de garants | Nombre de garants interveant pour la demande | "PCRetail - medecontractant en of borg dus 1 of 2 of 0 indien geen van beide aanwezig 0 = only main customer present 1 = co-contractant or garant present 2 = co-contractant and garant present" | justifié à droite (rechts), complété par des zéros à gauche (left)
          '  MedeContractanten, there is always 1 hoofdcontractant, therefore count-1
120       t.R03N027_DE_NB_GARANT = AppCn.GetFieldValueBySQL("SELECT Count(aanvraagnr)-1 FROM RELATIE WHERE aanvraagnr = '" & aRs!AV_ALG__AANVRAAGNR & "'", 1)
          '  Borg. C = 03 = Borg in ref tabel
130       If InStr(1, Trim(aRs!AV_SCORE__ZEKERHEDEN & ""), "C", vbTextCompare) Then t.R03N027_DE_NB_GARANT = CLng(t.R03N027_DE_NB_GARANT) + 1
          '  Format
140       t.R03N027_DE_NB_GARANT = CreateField(3, t.R03N027_DE_NB_GARANT, True, "0")
    
          ' R03A028_BLANC_61 As String * 18  ' 0163-0180 (018) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
150       t.R03A028_BLANC_61 = CreateField(18, "")
          ' R03A029_DE_CD_STATUT As String * 6   ' 0181-0186 (006) | Aanvraag status               | Constante: ‘1 ’ | Statut de la demande | "Statut de la demande au moment de l'extraction 0 : Non renseigné / Indéterminé 1 : Accepté 2 : En étude 3 : Refusée 4 : Annulée 5 : Autres" | Always = 1 | justifié à gauche (left), complété par des blancs à droite (rechts)
160       t.R03A029_DE_CD_STATUT = CreateField(6, "1")
          ' R03N030_DE_MT_FRAISDOS As String * 14  ' 0187-0200 (014) | Bedrag dossier                | Constante: +000000000,000 | Montant Frais de dossier | Montant Frais de dossier | Amount = 0 | +9(9),9(3)
170       t.R03N030_DE_MT_FRAISDOS = CreateField(14, "+000000000,000")
          ' R03A031_DUMMY_64 As String * 33  ' 0201-0233 (033) | Leeg                          | Vullen met x | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
180       t.R03A031_DUMMY_64 = CreateField(33, "", , "X")

190       Record_03_Demande = t

lbl_Exit:
200       Exit Function

lbl_Error:
210       Debug.Assert False
220       If HandleSilantError(Err.Number, "Module: INTF_BaleII_Module", "Record_03_Demande - Status: " & mstr_Status, Err.Description & " [" & UserID & "]") = 1 Then
230         GoTo lbl_Exit
240       Else
250         Resume Next
260       End If
End Function


Private Function Record_05_Financement_de_Bien(aRs As ADODB.Recordset, ByVal aPaliers As Long) As Record_05_Financement_de_Bien
          Dim t As Record_05_Financement_de_Bien
          Dim d As Double

          ' R05A039_FB_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’    |    Code filiale    |    "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)"    |    Pour la Hollande, valoriser à N    |    0
10        On Error GoTo lbl_Error

20        t.R05A039_FB_CD_FILIALE = "N"
          ' R05N040_FB_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
30        t.R05N040_FB_CD_SYSSRCE = "1"
          ' R05N041_FB_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
40        t.R05N041_FB_NO_DEMANDE = CreateField(15, mstr_PCFINETNR, True, "0")
          ' R05N042_FB_CODE_ENREG      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘05’ | Code enregistrement | Constante vaut "05" | Valoriser à '05' | 0
50        t.R05N042_FB_CODE_ENREG = "05"
    
    
          ' R05A043_FB_CD_PDFINAN      As String * 6   ' 0020-0025 (006) | Leeg                          | 0 | Code produit financier | "Code produit financier Il s'agit du code brut du produit de financement du bien rattaché à la demande" | Laisser à blanc - blanco laten | justifié à gauche (left), complété par des blancs à droite (rechts)
60        t.R05A043_FB_CD_PDFINAN = CreateField(6, "")
          ' R05N044_FB_MT_FINHORINT    As String * 14  ' 0026-0039 (014) | Financieel bedrag             | PCRetail DB - AV_FIN . FIN_BEDRAG | Montant financé hors intérêts | Montant total financé hors intérêts pour le bien rattaché, exprimé en Euros | PCRetail - AV_FIN / FIN_BEDRAG | +9(9),9(3)
70        t.R05N044_FB_MT_FINHORINT = CreateField(14, GetSaveNumber(aRs!AV_FIN__FIN_BEDRAG), True, , "+000000000.000", aUsePositiveNegativeForNr:=True)
          ' R05N045_FB_MT_APPORTINIT   As String * 14  ' 0040-0053 (014) | Aanbetaling                   | PCRetail DB - AV_FIN . AANBETAL | Montant de l'apport initial | Montant de l'apport initial sur la demande, exprimé en Euros | PCRetail - AV_FIN / AANBETAL | +9(9),9(3)
          ' change 100216-Proovit-EH: + AV_FIN__VERGOEDING @ request of MB/France
80        t.R05N045_FB_MT_APPORTINIT = CreateField(14, GetSaveNumber(aRs!AV_FIN__AANBETAL) + GetSaveNumber(aRs!AV_FIN__VERGOEDING), True, , "+000000000.000", aUsePositiveNegativeForNr:=True)
          ' R05A046_FB_TX_APPORT       As String * 8   ' 0054-0061 (008) | Koers                         | Niet beschikbaar bij PFNE | Taux Apport | Non lu par BRC | Information non disponible | 0
90        t.R05A046_FB_TX_APPORT = CreateField(8, "0")
          ' R05N047_FB_MT_REPCONT      As String * 14  ' 0062-0075 (014) | hergefinancierd bedrag        | PCRetail DB - AV_FIN . HERFIN_BED | Montant de reprise de l'ancien contrat | Montant reprise TTC, correspond au montant de reprise du véhicule lors de la demande de financement | PCRetail - AV_FIN / HERFIN_BED | +9(9),9(3)
100       t.R05N047_FB_MT_REPCONT = CreateField(14, GetSaveNumber(aRs!AV_FIN__HERFIN_BED), True, , "+000000000.000", aUsePositiveNegativeForNr:=True)
          ' R05A048_FB_NB_ECHEANCE     As String * 3   ' 0076-0078 (003) | Looptijd                      | PCRetail DB - AV_FIN . LOOPTIJD | Nombre d'échéances | Nombre d'échénances | PCRetail - AV_FIN / LOOPTIJD | 0
110       t.R05A048_FB_NB_ECHEANCE = CreateField(3, GetSaveNumber(Trim(aRs!AV_FIN__LOOPTIJD & "")), True, "0")
          ' R05A049_BLANC_82           As String * 1   ' 0079-0079 (001) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
120       t.R05A049_BLANC_82 = CreateField(1, " ")
          ' R05N050_FB_DU_PRET         As String * 8   ' 0080-0087 (008) | Looptijd                      | PCRetail DB - AV_FIN . LOOPTIJD | Durée du prêt | Durée du prêt prévue pour le financement du bien rattaché à la demande, exprimé en mois | PCRetail - AV_FIN / LOOPTIJD | +9(5),9(1)
130       t.R05N050_FB_DU_PRET = CreateField(8, GetSaveNumber(Trim(aRs!AV_FIN__LOOPTIJD & "")), , , "+00000.0")
          ' R05N051_FB_DU_PEREMB       As String * 8   ' 0088-0095 (008) | Constante                     | Constante: +00001,0 | Fréquence de remboursement | Périodicité du premier palier prévu pour le financement du bien rattaché à la demande, exprimé en mois | "valoriser à +00001,0 always équal at +00001,0" | +9(5),9(1)
140       t.R05N051_FB_DU_PEREMB = CreateField(8, "+00001,0")
          ' R05N052_FB_TX_TAN          As String * 8   ' 0096-0103 (008) | Nominale rente                | PCRetail DB - AV_FIN . INTEREST * 100 | Taux du contrat | "Taux nominal proportionnel à la demande (Taux Tan). Valeur par défaut: +999999,9" | "PCRetail - nominale rente voet - op te zoeken nominal rate = to verifiy in data base" | +9(5),9(1)
150       t.R05N052_FB_TX_TAN = CreateField(8, GetSaveNumber(aRs!AV_FIN__INTEREST) * 100, , , "+00000.0")
          ' R05N053_FB_TX_TAEG         As String * 8   ' 0104-0111 (008) | Effectieve rente              | Round((((1 + (PCRetail DB - AV_FIN . INTEREST )) ^ 12) - 1) * 100, 2) | Taux effectif global du prêt | "Taux TAEG Valeur par défaut: +999,999" | "PCRetail - effectieve rente voet - op te zoeken effective rate = to verify in data base" | +9(3),9(3)
160       t.R05N053_FB_TX_TAEG = CreateField(8, Round((((1 + (GetSaveNumber(aRs!AV_FIN__INTEREST))) ^ 12) - 1) * 100, 2), , , "+00000.0")
          ' R05D054_FB_DT_PREMECH      As String * 10  ' 0112-0121 (010) | Eerste termijn                | PCRetail DB - AV_FIN . BEGINDATUM | Date de première échéance | Date de la première échéance prévue pour le financement du bien rattaché à la demande | PCRetail - AV_FIN / BEGINDATUM ??? To verify | DD.MM.YYYY
170       t.R05D054_FB_DT_PREMECH = CreateField(10, CreateDate(aRs!AV_FIN__BEGINDATUM), , " ")
          ' R05N055_FB_MT_PREMECH      As String * 14  ' 0122-0135 (014) | Termijnen                     | PCRetail DB - AV_FIN . TERMIJN | Montant de la première échéance | Montant de la première échéance prévue pour le financement du bien rattaché à la demande, exprimé en Euro | PCRetail - AV_FIN / TERMIJN | +9(9),9(3)
180       t.R05N055_FB_MT_PREMECH = CreateField(14, GetSaveNumber(aRs!AV_FIN__TERMIJN), True, , "+000000000.000", aUsePositiveNegativeForNr:=True)
          ' R05N056_FB_MT_DEUXECH      As String * 14  ' 0136-0149 (014) | Restant                       | PCRetail DB - AV_FIN . RESTANT | Montant de la deuxième échéance | Montant de la deuxième échéance prévue pour le financement du bien rattaché à la demande, exprimé en Euro | PCRetail - AV_FIN / RESTANT | +9(9),9(3)
          ' 100528 PROOVIT-EH: Aanpassing op verzoek PFR (Mustapha aan Marc Beadle, zie mail 27-5-2010):
          ' "als de duur v. d. 1ste palier > 1 (= looptijd)
          '  dan:  bedrag van de 2de termijn (veldnr. 56)  = termijnbedrag (veldnr. 205) van de 1ste palier  (is dus m.i. ook = bedrag van de 1ste termijn)
          '  anders: bedrag van de 2de termijn = termijnbedrag van de 2de palier"

190       If GetSaveNumber(Trim(aRs!AV_FIN__LOOPTIJD & "")) = 0 Then
              ' 101123 PROOVIT-EH: Aanpassing op verzoek PFR (Mustapha):
200           d = 0
'38120 Debug.Assert False
210       ElseIf GetSaveNumber(Trim(aRs!AV_FIN__LOOPTIJD & "")) > 1 Then
220           d = GetSaveNumber(aRs!AV_FIN__TERMIJN)
230       Else
240           d = GetSaveNumber(aRs!AV_FIN__TERMIJN) + GetSaveNumber(aRs!AV_FIN__RESTANTBET)
250       End If
260       t.R05N056_FB_MT_DEUXECH = CreateField(14, d, True, , "+000000000.000", aUsePositiveNegativeForNr:=True)
          ' R05A057_DUMMY_90           As String * 84  ' 0150-0233 (084) | Leeg                          | Vullen met x-en | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
270       t.R05A057_DUMMY_90 = CreateField(84, "", , "X")

280       Record_05_Financement_de_Bien = t

lbl_Exit:
290       Exit Function

lbl_Error:
300       Debug.Assert False
310       If HandleSilantError(Err.Number, "Module: INTF_BaleII_Module", "Record_05_Financement_de_Bien - Status: " & mstr_Status, Err.Description & " [" & UserID & "]") = 1 Then
320         GoTo lbl_Exit
330       Else
340         Resume Next
350       End If
End Function


Private Function Record_06_Financement_de_Bien(aRs As ADODB.Recordset) As Record_06_Financement_de_Bien
          Dim t As Record_06_Financement_de_Bien
          Dim Dbl As Double
    
          ' R06A058_FB_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
10        On Error GoTo lbl_Error

20        t.R06A058_FB_CD_FILIALE = "N"
          ' R06N059_FB_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
30        t.R06N059_FB_CD_SYSSRCE = "1"
          ' R06N060_FB_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
40        t.R06N060_FB_NO_DEMANDE = CreateField(15, mstr_PCFINETNR, True, "0")
          ' R06N061_FB_Code_enreg      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘06’ | Code enregistrement | Constante vaut "06" | Valoriser à '06' | 0
50        t.R06N061_FB_Code_enreg = "06"
    
    
          ' R06D062_FB_DT_DERECH       As String * 10  ' 0020-0029 (010) | Datum laatste termijn         | PCRetail DB - AV_FIN . EINDDATUM | Date de dernière échéance | Date de dernière échéance | PCRetail - AV_FIN / EINDDATUM | DD.MM.YYYY
60        t.R06D062_FB_DT_DERECH = CreateField(10, CreateDate(aRs!AV_FIN__EINDDATUM), , " ")
          ' R06N063_FB_MT_DERECH       As String * 14  ' 0030-0043 (014) | Bedrag laatste termijn        | PCRetail DB berekening: AV_FIN . RESTANT + AV_FIN . TERMIJN | Montant de la dernière échéance | Montant de la dernière échéance prévue pour le financement du bien rattaché à la demande, exprimé en Euro | PCRetail - AV_FIN / RESTANT + TERMIJN | +9(9),9(3)
70        t.R06N063_FB_MT_DERECH = CreateField(14, GetSaveNumber(aRs!AV_FIN__RESTANTBET) + GetSaveNumber(aRs!AV_FIN__TERMIJN), True, , "+000000000.000", aUsePositiveNegativeForNr:=True)
          ' R06A064_FB_NB_MOISFRAN     As String * 3   ' 0044-0046 (003) | Aantal vrijstelling termijnen | Niet beschikbaar bij PFNE | Nbre de mois de franchise | Nbre de mois de franchise (Non lu par BRC) | Information non disponible | 0
80        t.R06A064_FB_NB_MOISFRAN = CreateField(3, "000")
          ' R06A065_BLANC_98           As String * 56  ' 0047-0102 (056) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
90        t.R06A065_BLANC_98 = CreateField(56, "")
          ' R06N066_FB_MT_INTAPERC     As String * 14  ' 0103-0116 (014) | Gefinancierd bedrag 1         | PCRetail DB berekening: AV_FIN . TERMIJN * LOOPTIJD + AV_FIN . RESTANT - FIN_BEDRAG (Zie ook PCRetail afrekening) | Montant des intérêts à percevoir | "Montant total des intérêts à percevoir pour le financement du bien rattaché à la demande" | PCRetail - AV_FIN / TERMIJN * LOOPTIJD + RESTANT - FIN_BEDRAG | +9(9),9(3)
100       t.R06N066_FB_MT_INTAPERC = CreateField(14, (GetSaveNumber(aRs!AV_FIN__TERMIJN) * GetSaveNumber(Trim(aRs!AV_FIN__LOOPTIJD & ""))) + GetSaveNumber(aRs!AV_FIN__RESTANTBET) - GetSaveNumber(aRs!AV_FIN__FIN_BEDRAG), True, , "+000000000.000", aUsePositiveNegativeForNr:=True)
          ' R06N067_FB_MT_FINAVINT     As String * 14  ' 0117-0130 (014) | Gefinancierd bedrag 2         | PCRetail DB berekening: AV_FIN . TERMIJN * LOOPTIJD + AV_FIN . RESTANT | Montant financé avec intérêts | "Montant financé avec intérêts au moment de la dernière extraction, n'intègre pas les frais de dossier, exprimé en Euro" | PCRetail - AV_FIN / TERMIJN * LOOPTIJD + RESTANT | +9(9),9(3)
110       t.R06N067_FB_MT_FINAVINT = CreateField(14, (GetSaveNumber(aRs!AV_FIN__TERMIJN) * GetSaveNumber(Trim(aRs!AV_FIN__LOOPTIJD & ""))) + GetSaveNumber(aRs!AV_FIN__RESTANTBET), True, , "+000000000.000", aUsePositiveNegativeForNr:=True)
          ' R06N068_FB_NB_QUANTPRE     As String * 3   ' 0131-0133 (003) | Looptijd                      | PCRetail DB - AV_FIN . LOOPTIJD | Nombre de quantième de prélèvement | Nombre de quantième de prélèvement | PCRetail - AV_FIN / LOOPTIJD | +9(9),9(3)
120       t.R06N068_FB_NB_QUANTPRE = CreateField(3, CLng("0" & Trim(aRs!AV_FIN__LOOPTIJD & "")), True, "0")
          ' R06A069_BLANC_102          As String * 49  ' 0134-0182 (049) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
130       t.R06A069_BLANC_102 = CreateField(49, "")
          ' R06N070_FB_MT_VR           As String * 14  ' 0183-0196 (014) | Restwaarde                    | Niet beschikbaar. | Montant valeur résiduelle | Montant valeur résiduelle | Information non disponible | +9(9),9(3)
140       t.R06N070_FB_MT_VR = CreateField(14, 0, True, , "+000000000.000")
          ' R06A071_DUMMY_104          As String * 37  ' 0197-0233 (037) | Leeg                          | Opvullen met x-en | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
150       t.R06A071_DUMMY_104 = CreateField(37, "", , "X")
    
160       Record_06_Financement_de_Bien = t

lbl_Exit:
170       Exit Function

lbl_Error:
180       Debug.Assert False
190       If HandleSilantError(Err.Number, "Module: INTF_BaleII_Module", "Record_06_Financement_de_Bien - Status: " & mstr_Status, Err.Description & " [" & UserID & "]") = 1 Then
200         GoTo lbl_Exit
210       Else
220         Resume Next
230       End If
End Function

 
Private Function Record_08_Vehicule(aRs As ADODB.Recordset) As Record_08_Vehicule
          Dim t As Record_08_Vehicule
          ' R08A072_VE_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
10        On Error GoTo lbl_Error

20        t.R08A072_VE_CD_FILIALE = "N"
          ' R08N073_VE_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
30        t.R08N073_VE_CD_SYSSRCE = "1"
          ' R08N074_VE_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
40        t.R08N074_VE_NO_DEMANDE = CreateField(15, mstr_PCFINETNR, True, "0")
          ' R08N075_VE_Code_enreg      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘08’ | Code enregistrement | Constante vaut "08" | Valoriser à '08' | 0
50        t.R08N075_VE_Code_enreg = "08"
 
          ' R08A076_VE_CD_TYPVEHIC     As String * 2   ' 0020-0021 (002) | Type auto                     | PCRetail DB - AV_OBJ / CATEGORIE : VN = nieuw , VO = gebruikt | Type de bien | "Identifiant du type de véhicule (neuf ou occasion) VN : Véhicule Neuf ou Véhicule de Démonstration VO : Véhicule d'Occasion SV : indéfini" | "PCRetail - AV_OBJ / CATEGORIE /// VN = nieuw /// VO = gebruikt VN = new vehicle /// VO = Second hand vehicle" | 0
60        If Trim(aRs!AV_OBJ__CATEGORIE & "") = "N" Then
70            t.R08A076_VE_CD_TYPVEHIC = CreateField(2, "VN") ' VN = nieuw | Véhicule Neuf ou Véhicule de Démonstration
80        ElseIf Trim(aRs!AV_OBJ__CATEGORIE & "") = "G" Then
90            t.R08A076_VE_CD_TYPVEHIC = CreateField(2, "VO") ' VO = gebruikt | Véhicule d'Occasion
100       Else
110           t.R08A076_VE_CD_TYPVEHIC = CreateField(2, "SV") ' SV : indéfini
120       End If
    
          ' R08A077_BLANC_110          As String * 8   ' 0022-0029 (008) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
130       t.R08A077_BLANC_110 = CreateField(8, "")
          ' R08D078_VE_DT_PREMIMMA     As String * 10  ' 0030-0039 (010) | Datum inschrijving auto       | PCRetail - AV_OBJ / BOUWJAAR : 01.07.YYYY (yyyy = bouwjaar, enkel jaar is beschikbaar) | Date de première immatriculation du Véhicule d'Occasion | "Date de première immatriculation du véhicule Si la date est absente ou s'il s'agit d'un véhicule neuf , mettre 01.01.1801" | "PCRetail - AV_OBJ / BOUWJAAR /// 01.07.YYYY enkel jaar beschikbaar only the year is available in data base Renseigner par 01.07.YYYY" | DD.MM.YYYY
140       t.R08D078_VE_DT_PREMIMMA = "01.07." & CreateField(4, aRs!AV_OBJ__BOUWJAAR & "")
          ' R08A079_BLANC_112          As String * 31  ' 0040-0070 (031) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
150       t.R08A079_BLANC_112 = CreateField(31, "")
          ' R08N080_VE_MT_PRIXCATA     As String * 14  ' 0071-0084 (014) | Cataloguswaarde               | Niet beschikbaar bij PFNE | Prix catalogue du véhicule | "Prix du véhicule rattaché à a demande, exprimé en Euro Pour les VO, il s'agit de la cotation officielle, Pour les VN, il s'agit du prix de vente au public de référence" | Information non disponible | +9(9),9(3)
160       t.R08N080_VE_MT_PRIXCATA = CreateField(14, 0, True, , "+000000000.000")
          ' R08N081_VE_MT_PRIXACHA     As String * 14  ' 0085-0098 (014) | Nieuwprijs voertuig           | PCRetail DB - AV_FIN . VERKPRIJS | Prix d'achat du véhicule | "Prix d'achat du véhicule rattaché à la demande, exprimé en Euro Il s'agit du prix final proposé au client, il intégre les éventuels accessoires et options , ainsi que les remises. Il ne comprend pas la reprise éventuelle d'un véhicule" | PCRetail - AV_FIN / VERKPRIJS | +9(9),9(3)
170       t.R08N081_VE_MT_PRIXACHA = CreateField(14, GetSaveNumber(aRs!AV_FIN__VERKPRIJS), True, , "+000000000.000")
          ' R08A082_BLANC_115          As String * 76  ' 0099-0174 (076) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
180       t.R08A082_BLANC_115 = CreateField(76, "")
    
          ' R08A083_VE_CD_GENRE        As String * 2   ' 0175-0176 (002) | Soort auto (privé of zakelijk)| PCRetail DB - AV_OBJ . SOORTAUTO: via stamtabel “automobiel” | Code type utilisation de bien | "Identifiant du genre de véhicule rattaché à la demande: VU : Véhicule Utilitaire VP : Véhicule Particulier" | PCRetail - AV_OBJ / SOORTAUTO | 0
190       If Trim(aRs!AV_OBJ__SOORTAUTO & "") = "B" Then
200           t.R08A083_VE_CD_GENRE = CreateField(2, "VU") ' VU : Véhicule Utilitaire
210       ElseIf Trim(aRs!AV_OBJ__SOORTAUTO & "") = "P" Then
220           t.R08A083_VE_CD_GENRE = CreateField(2, "VP") ' VP : Véhicule Particulier
230       Else
240           t.R08A083_VE_CD_GENRE = CreateField(2, "VP") ' ?
      '38290         Call Err.Raise(vbObjectError, "PCRETAIL.INTF_BaleII_Module.Record_08_Vehicule", "WARN 1002152341: Creating record 08 for demand '" & aRs!AV_ALG__AANVRAAGNR & " resulted in a unset value for business or private car; private was assumed.")
250           mbln_SkipRecord = False
              'GoTo lbl_Exit
260       End If
    
          ' R08A084_BLANC_117          As String * 28  ' 0177-0204 (028) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
270       t.R08A084_BLANC_117 = CreateField(28, "")
          ' R08N085_VE_MT_OPTVEHCONS   As String * 11  ' 0205-0215 (011) | Bedrag auto toebehoren        | Niet beschikbaar bij PFNE | Montant des accessoires concessionnaires | Montant des accessoires concessionnaires | Information non disponible | +9(7),9(2)
280       t.R08N085_VE_MT_OPTVEHCONS = CreateField(11, 0, True, , "+0000000.00")
          ' R08A086_BLANC_119          As String * 3   ' 0216-0218 (003) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
290       t.R08A086_BLANC_119 = CreateField(3, "")
          ' R08N087_VE_MT_OPTVEHCE     As String * 11  ' 0219-0229 (011) | Bedrag auto accessoires       | Niet beschikbaar bij PFNE | Montant des accessoires véhicule | Montant des accessoires véhicule | Information non disponible | +9(7),9(2)
300       t.R08N087_VE_MT_OPTVEHCE = CreateField(11, 0, True, , "+0000000.00")
          ' R08A088_BLANC_121          As String * 3   ' 0230-0232 (003) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
310       t.R08A088_BLANC_121 = CreateField(3, "")
          ' R08A089_DUMMY_122          As String * 1   ' 0233-0233 (001) | Leeg                          | Vullen met x-en | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
320       t.R08A089_DUMMY_122 = CreateField(1, "", , "X")
    
330       Record_08_Vehicule = t

lbl_Exit:
340       Exit Function

lbl_Error:
350       Debug.Assert False
360       If HandleSilantError(Err.Number, "Module: INTF_BaleII_Module", "Record_08_Vehicule - Status: " & mstr_Status, Err.Description & " [" & UserID & "]") = 1 Then
370         GoTo lbl_Exit
380       Else
390         Resume Next
400       End If
End Function


Private Function Record_10_Intervenant(aRs As ADODB.Recordset, aRoll As Long) As Record_10_Intervenant
          Dim t As Record_10_Intervenant
          Dim s As String
          Dim B As String
    
          ' R10A090_IN_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
10        On Error GoTo lbl_Error

20        t.R10A090_IN_CD_FILIALE = "N"
          ' R10N091_IN_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
30        t.R10N091_IN_CD_SYSSRCE = "1"
          ' R10N092_IN_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
40        t.R10N092_IN_NO_DEMANDE = CreateField(15, mstr_PCFINETNR, True, "0")

50    Debug.Assert Not mstr_PCFINETNR = "13490000366"

          ' R10N093_IN_Code_enreg      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘10’ | Code enregistrement | Constante vaut "10" | Valoriser à '10' | 0
60        t.R10N093_IN_Code_enreg = "10"
    
          ' R10A094_IN_CD_ROLE         As String * 6   ' 0020-0025 (006) | Rol                           | PCRetail functie: Hoofdklant = 1 , Borg = 2 , medecontractant = 3 | Identifiant du rôle de l'intervenant | "Identifiant du rôle de l'intervenant 0 : Non renseigné / Intdéterminé 1 : client 2 : garant, participant 3 : co-demandeur, co-emprunteur 4 : autre cas" | "Hoofdklant = 1 /// Borg = 2 /// medecontractant = 3 Main customer = 1 /// Garant = 2 /// Co-contractant = 3" | justifié à gauche (left), complété par des blancs à droite (rechts)
70        t.R10A094_IN_CD_ROLE = CreateField(6, CStr(aRoll))
          ' R10A095_IN_CD_TYPDEM       As String * 1   ' 0026-0026 (001) | Leeg                          | 0 | Type de demandeur | Type de demandeur | Valoriser à blanc | 0
80        t.R10A095_IN_CD_TYPDEM = CreateField(1, "")
          ' R10A096_IN_NO_CLIBCU       As String * 9   ' 0027-0035 (009) | Klantnummer                   | Niet beschikbaar bij PFNE | Numéro de client | N° client attribué au demandeur lors de l’enregistrement de la demande en gestion provisoire (si cela est effectué dès la gestion provisoire), sinon en gestion définitive. | Information non disponible - le n° d'intervenant (dans BI) est seulement attribué dans le traitement de l'interface de la mise en gestion définitive sur GVAC, donc après que le contract est parti de PC-Retail | justifié à gauche (left), complété par des blancs à droite (rechts)
90        t.R10A096_IN_NO_CLIBCU = CreateField(9, "")
    
          ' R10A097_BLANC_130          As String * 79  ' 0036-0114 (079) | Overslaan                     | Overslaan | Champs non renseignés pour Bâle II | Blanc | 0 | 0
100       t.R10A097_BLANC_130 = CreateField(79, "")
          ' R10A098_IN_FICH_INT        As String * 6   ' 0115-0120 (006) | Overslaan                     | Overslaan | Code fichage Interne | Code fichage interne (FIP) | A définir par les modélisateurs | 0
110       t.R10A098_IN_FICH_INT = CreateField(6, "")
          ' R10A099_IN_CD_FICHEXT      As String * 6   ' 0121-0126 (006) | Overslaan                     | Overslaan | Code fichier externe | Code fichier externe | A définir par les modélisateurs | 0
120       t.R10A099_IN_CD_FICHEXT = CreateField(6, "")
          ' R10A100_BLANC_133          As String * 7   ' 0127-0133 (007) | Overslaan                     | Overslaan | Champs non renseignés pour Bâle II | Blanc | 0 | 0
130       t.R10A100_BLANC_133 = CreateField(7, "")
          ' R10N101_IN_MT_RKCONSOL     As String * 14  ' 0134-0147 (014) | Overslaan                     | Overslaan | Encours consolidé au client | Montant risque consolidé | Information non disponible | +9(9),9(3)
140       t.R10N101_IN_MT_RKCONSOL = CreateField(14, "")
          ' R10A102_BLANC_135          As String * 14  ' 0148-0161 (014) | Overslaan                     | Overslaan | Champs non renseignés pour Bâle II | Blanc | 0 | 0
150       t.R10A102_BLANC_135 = CreateField(14, "")
          ' R10A103_IN_CD_SCORE        As String * 6   ' 0162-0167 (006) | Overslaan                     | Overslaan | Identifiant du type de score | Identifiant du type de score | A définir par les modélisateurs | justifié à gauche (left), complété par des blancs à droite (rechts)
          ' 100715 PROOVIT-EH: Always 'VAC' on request of mustapha.touile@ext.mpsa.com
          ' 101003 PROOVIT-EH: Always 62 iso 'VAC' on request of mustapha.touile@ext.mpsa.com
160       t.R10A103_IN_CD_SCORE = CreateField(6, "62")
          ' R10N104_IN_NO_VERSCORE     As String * 3   ' 0168-0170 (003) | Overslaan                     | Overslaan | Numéro de version du score | "Numéro de version du score, commence à 1" | A définir par les modélisateurs | 9(3)
170       t.R10N104_IN_NO_VERSCORE = CreateField(3, "")
          ' R10D105_IN_DT_CLSCORE      As String * 10  ' 0171-0180 (010) | Overslaan                     | Overslaan | Date de calcul du score | "Date de calcul du score Si la date est absente, mettre 01.01.1801" | A définir par les modélisateurs | DD.MM.YYYY
          ' 100715 PROOVIT-EH: Scorix AV.AV_TSTAMP_ACCEPT request of mustapha.touile@ext.mpsa.com
          ' NOT AVAILABLE in PCRetail...
180       t.R10D105_IN_DT_CLSCORE = CreateField(10, "")
          ' R10A106_IN_CD_TRANCHSCO    As String * 6   ' 0181-0186 (006) | Overslaan                     | Overslaan | Tranche de score | Tranche de score de la demande | A définir par les modélisateurs | justifié à gauche (left), complété par des blancs à droite (rechts)
          ' 100715 PROOVIT-EH: composed data at request of mustapha.touile@ext.mpsa.com:
          '        PSA SCORE KLASSE (only the digit) + BKR score klasse (1digit) + avstatus (on 3 digits)
          '        Ex : AX021,B_031, ...
          '        if value unknown for each composant then replace by "_"
          ' 101003 PROOVIT-EH: re-composed data at request of mustapha.touile@ext.mpsa.com:
190       s = ""
200       If aRoll = 1 Then
210           Select Case Trim(aRs!AV_SCORE__KLASSE & "")
                  Case "A": s = 3
220               Case "B": s = 6
230               Case "C": s = 9
240               Case "D": s = 12
250           End Select
260       End If
270       If Not IsNumeric(s) Then s = -1
280       t.R10A106_IN_CD_TRANCHSCO = CreateField(6, s)
          ' R10N107_IN_NB_NOTESCORE    As String * 5   ' 0187-0191 (005) | Overslaan                     | Overslaan | Note de score | "Note de score en nombre de points" | A définir par les modélisateurs | +9(4)
          ' 100715 PROOVIT-EH: note de score (if not valued --> put +9999 = default blank value) request of mustapha.touile@ext.mpsa.com
290       s = Trim(aRs!AV_SCORE__SCORE & "")
300       If s = "" Then
310           s = "+9999"
320       Else
330           s = "+" & Right("0000" & s, 4)
340       End If
350       t.R10N107_IN_NB_NOTESCORE = CreateField(6, s)
          ' R10A108_IN_FICH_EXT1       As String * 2   ' 0192-0193 (002) | Overslaan                     | Overslaan | Note Externe CRIF | "données spécifique à l'Italie - Lues pour toutes les filiales Code fichage externe 1 COTE D’ACTIVITE BDF Pour un dirigeant d’entreprise (profession libéral et artisan inclus)" | A définir par les modélisateurs | 0
360       t.R10A108_IN_FICH_EXT1 = CreateField(2, "")
          ' R10A109_BLANC_142          As String * 4   ' 0194-0197 (004) | Overslaan                     | Overslaan | Champs non renseignés pour Bâle II | Blanc | 0 | 0
370       t.R10A109_BLANC_142 = CreateField(4, "")
    
          ' R10A110_IN_FICH_EXT4       As String * 4   ' 0198-0201 (004) | Score                         | Zie scoring in PCRetail. De functie ScoreCard berekent de score. Formaat totaal score = letter+punten bv A234 | Score CREFO / Pour L'Italie SCORE EXPERIAN (nouveau) | Score CREFO / Pour L'Italie SCORE EXPERIAN (nouveau) | "Formaat totaal score = letter+punten bv A234 /// nog uit te zoeken in PC-Retail Format of total score = character + total points ex A234 /// to verifiy in PCRetail data base " | 0
          ' 101003 PROOVIT-EH: re-composed data at request of mustapha.touile@ext.mpsa.com:
          ' 101123 PROOVIT-EH: adjusted: split up in pairs of 2, fist 2 are for italy @ request of mustapha.touile@ext.mpsa.com:
380       B = Trim(aRs!AV_SCORE__BKRSCORE & "")
390       s = Trim(aRs!AV_SCORE__AANTBKRCONTR & "")
400       t.R10A110_IN_FICH_EXT4 = CreateField(2, B) & CreateField(2, s)
          ' R10A111_BLANC_144          As String * 7   ' 0202-0208 (007) | Overslaan                     | Overslaan | Champs non renseignés pour Bâle II | Blanc | 0 | 0
          ' 101003 PROOVIT-EH: re-composed data at request of mustapha.touile@ext.mpsa.com:
410       t.R10A111_BLANC_144 = CreateField(7, " ")
    
          ' R10A112_IN_FICH_EXT9       As String * 2   ' 0209-0210 (002) | Overslaan                     | Overslaan | SCORE EXPERIAN ancien | "Code fichage externe 9 CODE IMPAYE Pour une entreprise Ajoutée pour PFIT. Lue pour toutes les filiales" | A définir par les modélisateurs | 0
420       t.R10A112_IN_FICH_EXT9 = CreateField(2, "")
          ' R10A113_BLANC_146          As String * 16  ' 0211-0226 (016) | Overslaan                     | Overslaan | Champs non renseignés pour Bâle II | Blanc | 0 | 0
430       t.R10A113_BLANC_146 = CreateField(16, "")
          ' R10A114_IN_FICH_EXT11      As String * 4   ' 0227-0230 (004) | Overslaan                     | Overslaan | score FIBEN | "Code FICHAGE EXTERNE 11 données spécifique à la France, lues pour toutes les filiales. Ce champ contient à la fois la cotation FIBEN Dirigeant et la cotation FIBEN Entreprise Nouvelle cotation BDF mis en place à partir du 5 avril 2004" | A définir par les modélisateurs | 0
440       t.R10A114_IN_FICH_EXT11 = CreateField(4, "")
          ' R10A115_DUMMY_148          As String * 3   ' 0231-0233 (003) | Overslaan                     | Overslaan | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
450       t.R10A115_DUMMY_148 = CreateField(3, "", , "X")
    
460       Record_10_Intervenant = t

lbl_Exit:
470       Exit Function

lbl_Error:
480       Debug.Assert False
490       If HandleSilantError(Err.Number, "Module: INTF_BaleII_Module", "Record_10_Intervenant - Status: " & mstr_Status, Err.Description & " [" & UserID & "]") = 1 Then
500         GoTo lbl_Exit
510       Else
520         Resume Next
530       End If
End Function


Private Function Record_11_Particulier(aRs As ADODB.Recordset, aRsC As ADODB.Recordset) As Record_11_Particulier
          Dim t As Record_11_Particulier
    
          ' R11A116_PA_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
10        On Error GoTo lbl_Error

20        t.R11A116_PA_CD_FILIALE = "N"
          ' R11N117_PA_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
30        t.R11N117_PA_CD_SYSSRCE = "1"
          ' R11N118_PA_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
40        t.R11N118_PA_NO_DEMANDE = CreateField(15, mstr_PCFINETNR, True, "0")
          ' R11N119_PA_Code_enreg      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘11’ | Code enregistrement | Constante vaut "11" | Valoriser à '11' | 0
50        t.R11N119_PA_Code_enreg = "11"
    
          ' R11A120_PA_NO_IDENT        As String * 20  ' 0020-0039 (020) | Overslaan                     | 0 | Identifiant national | Identifiant national du demandeur, blanc si non géré dans la filiale | Information non disponible | justifié à gauche (left), complété par des blancs à droite (rechts)
60        t.R11A120_PA_NO_IDENT = CreateField(20, "")
          ' R11D121_PA_DT_NAISS        As String * 10  ' 0040-0049 (010) | Geboortedatum                 | PCRetail DB - RELATIE . GEBDATUM | Date de naissance pour le particulier | "Date de naissance pour le particulier Si la date est absente, mettre 01.01.1801" | PCRetail - RELATIE / GEBDATUM | DD.MM.YYYY
70        t.R11D121_PA_DT_NAISS = CreateField(10, CreateDate(aRsC!gebdatum, "00.00.0000"))
          ' R11A122_BLANC_155          As String * 94  ' 0050-0143 (094) | Leeg                          | Leeg | Champs non renseignés pour Bâle II | Blanc | 0 | 0
80        t.R11A122_BLANC_155 = CreateField(94, "")
          ' R11D123_PA_DT_EXPSEJOUR    As String * 10  ' 0144-0153 (010) | Leeg                          | Leeg | Date d'expiration du permis de séjour | "Date d'expiration du permis de séjour, Si la date est absente, mettre 01.01.1801" | Information non disponible | DD.MM.YYYY
90        t.R11D123_PA_DT_EXPSEJOUR = CreateField(10, "")
          ' R11A124_BLANC_157          As String * 22  ' 0154-0175 (022) | Leeg                          | Leeg | Champs non renseignés pour Bâle II | Blanc | 0 | 0
100       t.R11A124_BLANC_157 = CreateField(22, "")
          ' R11A125_DUMMY_158          As String * 58  ' 0176-0233 (058) | Leeg                          | Leeg | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
110       t.R11A125_DUMMY_158 = CreateField(58, "", , "X")
    
120       Record_11_Particulier = t

lbl_Exit:
130       Exit Function

lbl_Error:
140       Debug.Assert False
150       If HandleSilantError(Err.Number, "Module: INTF_BaleII_Module", "Record_11_Particulier - Status: " & mstr_Status, Err.Description & " [" & UserID & "]") = 1 Then
160         GoTo lbl_Exit
170       Else
180         Resume Next
190       End If
End Function
                                                                              
Private Function Record_12_Particulier(aRs As ADODB.Recordset, aRsC As ADODB.Recordset) As Record_12_Particulier
          Dim t As Record_12_Particulier
          Dim d As Double
          Dim s As String
    
10        On Error GoTo lbl_Error

          ' R12A126_PA_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
20        t.R12A126_PA_CD_FILIALE = "N"
          ' R12N127_PA_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
30        t.R12N127_PA_CD_SYSSRCE = "1"
          ' R12N128_PA_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
40        t.R12N128_PA_NO_DEMANDE = CreateField(15, mstr_PCFINETNR, True, "0")
          ' R12N129_PA_Code_enreg      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘12’ | Code enregistrement | Constante vaut "12" | Valoriser à '12' | 0
50        t.R12N129_PA_Code_enreg = "12"
    
          ' R12A130_PA_CD_POSTAL       As String * 10  ' 0020-0029 (010) | Postcode                      | PCRetail DB - RELATIE . POSTCODE | Code postal | "Code postal de la résidence du demandeur au moment de la dernière mise à jour de la demande" | PCRetail - RELATIE / POSTCODE | justifié à gauche (left), complété par des blancs à droite (rechts)
60        t.R12A130_PA_CD_POSTAL = CreateField(10, aRsC!Postcode & "")
          ' R12A131_BLANC_164          As String * 70  ' 0030-0099 (070) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
70        t.R12A131_BLANC_164 = CreateField(70, "")
          ' R12A132_PA_CD_SITUFAM      As String * 6   ' 0100-0105 (006) | Burgerlijke stand             | PCRetail DB - RELATIE . BURGSTATUS **Vergelijk stamtabel PCRetail met deze | Statut familial du demandeur | "Statut familial du demandeur 0 : Non renseigné / Indeterminé 1 : Marié 2 : Célibataire 3 : Veuf 4 : Divorcé 5 : Séparé 6 : Concubin 7 : Autres" | PCRetail - RELATIE / BURGSTATUS | justifié à gauche (left), complété par des blancs à droite (rechts)
          ' 100716 PROOVIT-EH: FR is proposing: 0 >-1  |  1 > 1  |  2 > 2  |  3 > 4  |  4 > 6  |  5 > 3
80        Select Case Trim(aRsC!Burgstatus & "")
              Case "01" ' Ongehuwd
90                t.R12A132_PA_CD_SITUFAM = CreateField(6, "7") '7: Autres = Overige
100           Case "02" ' Gehuwd
110               t.R12A132_PA_CD_SITUFAM = CreateField(6, "1") '1: Marié = Getrouwd
120           Case "03" ' Weduwe/weduwnaar
130               t.R12A132_PA_CD_SITUFAM = CreateField(6, "3") '3: Veuf = Weduwe / weduwnaar
140           Case "04" ' Gescheiden
150               t.R12A132_PA_CD_SITUFAM = CreateField(6, "4") '4: Divorcé = Gescheiden
160           Case "05" ' Samenwonend
170               t.R12A132_PA_CD_SITUFAM = CreateField(6, "6") '6: Concubin = Samenwonend
180           Case Else ' "06" ' Onbekend
190               t.R12A132_PA_CD_SITUFAM = CreateField(6, "-1") '0: Non renseigné / Indeterminé = Onbekend / Onbepaald
200       End Select
     
          ' R12N133_PA_NB_ENFANT       As String * 3   ' 0106-0108 (003) | Kinderen                      | PCRetail DB - RELATIE . KINDEREN | Nombre d'enfants à charge | Nombre d'enfants à charge | PCRetail - RELATIE / KINDEREN | 9(3)
210       t.R12N133_PA_NB_ENFANT = CreateField(3, CLng("0" & Trim(aRsC!Kinderen & "")), True, "0")
          ' R12N134_PA_NB_PERSCHARG    As String * 3   ' 0109-0111 (003) | Aantal personen               | Niet beschikbaar bij PFNE * Wat in te vullen? Hoofdcontractant, medecontractant + kinderen? | Nombre de personnes à charge | Nombre de personnes à charge | Information non disponible | 9(3)
220       t.R12N134_PA_NB_PERSCHARG = CreateField(3, CLng("0" & AppCn.GetFieldValueBySQL("SELECT Count(aanvraagnr) FROM RELATIE WHERE aanvraagnr = '" & aRs!AV_ALG__AANVRAAGNR & "'", 0)) + CLng("0" & Trim(aRsC!Kinderen & "")), True, "0")
          ' R12A135_PA_CD_SITULOGMT    As String * 6   ' 0112-0117 (006) | Woonsituatie                  | PCRetail DB - RELATIE . BEHUIZING **Vergelijk stamtabel PCRetail met deze | Code situation logement | "Situation au logement du demandeur 0 : Non renseigné / Indéterminé 1 : Propriétaire d'un appartement 2 : Propriétaire d'une maison 3 : Propriétaire 4 : Locataire 5 : Loge chez Parents 6 : Loge chez Employeur 7 : Loge chez tiers 8 : Loge chez quelqu'un (quand pas détail) 9 : Caravane 10 : Hôtel 11 : Foyer 12 : Autres" | PCRetail - RELATIE / BEHUIZING | justifié à gauche (left), complété par des blancs à droite (rechts)
230       Select Case Trim(aRsC!Behuizing & "")
              Case "01" ' EHS;Eigen huis; 10;; 1
240               t.R12A135_PA_CD_SITULOGMT = CreateField(6, "2") ' 2 : Propriétaire d'une maison
250           Case "02" ' HHS;Huurhuis; 20;; 2
260               t.R12A135_PA_CD_SITULOGMT = CreateField(6, "4") ' 4 : Locataire = huurder
270           Case "04" ' INW;Inwonend bij ouders; 40;; 3
280               t.R12A135_PA_CD_SITULOGMT = CreateField(6, "5") ' 5 : Loge chez Parents
290           Case Else ' "03" ' ONB;Onbekend; 30;; 4
300               t.R12A135_PA_CD_SITULOGMT = CreateField(6, "0") ' 0 : Non renseigné / Indéterminé  = Onbekend / Niet gegeven
310       End Select
    
          ' R12A136_BLANC_169          As String * 1   ' 0118-0118 (001) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
320       t.R12A136_BLANC_169 = CreateField(1, "")
          ' R12N137_PA_DU_ANCLOGMT     As String * 6   ' 0119-0124 (006) | Woonduur                      | PCRetail DB - RELATIE . WOON_DUUR | Ancienneté dans le logement | "Ancienneté de l'intervenant dans le logement, exprimée en mois Si calculée = Date de la demande - date d'entrée au logement" | PCRetail - RELATIE / WOON_DUUR | +9(3),9(1)
          Dim SW As String
330       SW = ""
340       On Error Resume Next
350       SW = Trim(aRsC!STARTWONING & "")
360       On Error GoTo 0
370       d = 0
380       If IsDate(SW) Then
390           d = DateDiff("m", CDate(SW), CDate(Year(Now()) & "-01-01"))
400           If d < -999 Then d = -999.9
410           If d > 999 Then d = 999.9
420       End If
430       t.R12N137_PA_DU_ANCLOGMT = CreateField(6, d, True, , "+000.0", aUsePositiveNegativeForNr:=True)
    
'39860     Select Case Trim(aRsC!Woon_duur & "")
'              Case "01" ' ZK;< 1 jaar; 10;; 1;;"
'39870             t.R12N137_PA_DU_ANCLOGMT = CreateField(6, 0.9, True, , "+000.0", aUsePositiveNegativeForNr:=True)
'39880         Case "02" ' K;1 of 2 jaar; 20;; 2;;"
'39890             t.R12N137_PA_DU_ANCLOGMT = CreateField(6, 1.9, True, , "+000.0", aUsePositiveNegativeForNr:=True)
'39900         Case "03" ' L;2 tot 5 jaar; 30;; 3;;"
'39910             t.R12N137_PA_DU_ANCLOGMT = CreateField(6, 4.9, True, , "+000.0", aUsePositiveNegativeForNr:=True)
'39920         Case "04" ' ZL;> 5 jaar; 40;; 4;;"
'39930             t.R12N137_PA_DU_ANCLOGMT = CreateField(6, 5.1, True, , "+000.0", aUsePositiveNegativeForNr:=True)
'39940         Case "05" ' ON;Onbekend; 50;; 5;;"
'39950             t.R12N137_PA_DU_ANCLOGMT = CreateField(6, -1, True, , "+000.0", aUsePositiveNegativeForNr:=True)
'39960         Case Else
'39970             t.R12N137_PA_DU_ANCLOGMT = "+000.0"
'39980     End Select
    
          ' R12A138_PA_CD_SITUPROF     As String * 6   ' 0125-0130 (006) | Werksituatie                  | Niet beschikbaar bij PFNE | Code situation professionnelle spécifique aux filiales | Code situation professionnelle spécifique aux filiales | Information non disponible | 0
440       t.R12A138_PA_CD_SITUPROF = CreateField(6, "")
          ' R12A139_PA_CD_SITUPROFCOM  As String * 6   ' 0131-0136 (006) | Code Beroep                   | Niet beschikbaar bij PFNE, waarde = 0 | Code situation professionnelle commun aux filiales | "Code situation professionnelle dans le référentiel commun 0 : Non renseigné / Indéterminé 1 : Ouvrier 2 : Retraité 3 : Fonctionnaire 4 : Officier 5 : Soldat 6 : Indépendant 7 : Femme au foyer 8 : Etudiant 9 : Employé - Salarié 10 : Cadre moyen 11 : Cadre supérieur 12 : Agriculteur 13 : Artisan - Petit commerçant 14 : Patron - Gros commerçant 15 : Profession libérale 16 : Inactif 17 : Rentier 18 : Autres" | = 0 | justifié à gauche (left), complété par des blancs à droite (rechts)
          ' 101123 PROOVIT-EH: adjust: set to 0, put value in field 144 @ request of mustapha.touile@ext.mpsa.com:
'40010     s = Trim(aRsC!Cat_Beroep & "")
'40020     Select Case s
'              Case "1": s = "5"
'40030         Case "2": s = "4"
'40040         Case "3": s = "3"
'40050         Case "4": s = "6"
'40060         Case "5": s = "2"
'40070         Case "6": s = "7"
'40080         Case "7": s = "1"
'40090         Case "8": s = "3"
'40100         Case "9": s = "7"
'40110         Case "10": s = "9"
'40120         Case Else
'40130           s = "0"
'40140     End Select
'40150     t.R12A139_PA_CD_SITUPROFCOM = CreateField(6, s)
450       t.R12A139_PA_CD_SITUPROFCOM = CreateField(6, "0")
          ' R12N140_PA_DU_ANCEMPL      As String * 6   ' 0137-0142 (006) | Datum in dienst               | PCRetail DB - RELATIE . STARTWERK Berekenen; is een datum in dienst. In jaren? Wat is de waarde bij niet beschikbaar? | Ancienneté dans l'emploi | "Ancienneté de l'intervenant dans l'emploi qu'il occupe au moment de la dernière mise à jour de la demande, exprimée en mois Si calculée = Date de la demande - date d'entrée en fonction " | PCRetail - RELATIE / STARWERK | +9(3),9(1)
460       If IsNull(aRsC!StartWerk) Then
470           t.R12N140_PA_DU_ANCEMPL = CreateField(6, 0, True, , "+000.0", aUsePositiveNegativeForNr:=True)
480       Else
              ' 100425 PROOVIT-EH: Getting values like '31-12-9999'...
490           On Error Resume Next
500           d = 0
510           If Year(aRsC!StartWerk) < 1900 Then
520             d = 0
530           Else
540               d = DateDiff("m", aRsC!StartWerk, Now)
550               If d < 0 Then d = 0
560               If d > 999.9 Then d = 999.9
570           End If
580           On Error GoTo lbl_Error
590           t.R12N140_PA_DU_ANCEMPL = CreateField(6, d, True, , "+000.0", aUsePositiveNegativeForNr:=True)
600       End If
    
          ' R12A141_BLANC_174          As String * 16  ' 0143-0158 (016) | Leeg                          | Leeg of niet beschikbaar | Champs non renseignés pour Bâle II | Blanc | 0 | 0
610       t.R12A141_BLANC_174 = CreateField(16, "")
          ' R12A142_PA_CD_SECACT       As String * 6   ' 0159-0164 (006) | Leeg                          | Leeg of niet beschikbaar | Code secteur d'activité spécifique aux filiales | "Code brut du secteur d'activité de l'intervenant particulier => Fournir la table de référence spécifique à la filiale " | Information non disponible | justifié à gauche (left), complété par des blancs à droite (rechts)
620       t.R12A142_PA_CD_SECACT = CreateField(6, "")
          ' R12A143_PA_CD_SECTACTCOM   As String * 6   ' 0165-0170 (006) | Leeg                          | Leeg of niet beschikbaar | Code secteur d'activité commun aux filiales | "Code du secteur d'activité de l'intervenant particulier dans le référentiel commun 0 : Non renseigné - Indéterminé 1 : Agriculture - Chasse - Sylviculture 2 : Pêche - Aquaculture 3 : Industries extractives 4 : Industries manufacturées 5 : Production Distribution électrique 6 : Construction 7 : Commerce - Réparation automobile 8 : Hôtel - Restaurant 9 : Transport - Communication 10 : Activités financières 11 : Immobilier 12 : Administration publique 13 : Education 14 : Santé - Action sociale 15 : Services collectifs sociaux 16 : Services domestiques 17 : Activités extra-territoriales 18 : Autres 19 : Média - Communication 20 : Marketing - Ventes" | Information non disponible | justifié à gauche (left), complété par des blancs à droite (rechts)
630       t.R12A143_PA_CD_SECTACTCOM = CreateField(6, "")
          ' R12A144_PA_CD_TYPCONTPRO   As String * 6   ' 0171-0176 (006) | Leeg                          | Leeg of niet beschikbaar | Function de contrat | Function de contrat professionnel de l'intervenant (ex: CDD, CDI, Apprenti …) | Information non disponible | 0
640       s = Trim(aRsC!Cat_Beroep & "")
650       t.R12A144_PA_CD_TYPCONTPRO = CreateField(6, s)
          ' R12A145_DUMMY_178          As String * 57  ' 0177-0233 (057) | Leeg                          | Leeg of niet beschikbaar | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
660       t.R12A145_DUMMY_178 = CreateField(57, "", , "X")
    
670       Record_12_Particulier = t

lbl_Exit:
680       Exit Function

lbl_Error:
690       Debug.Assert False
700       If HandleSilantError(Err.Number, "Module: INTF_BaleII_Module", "Record_12_Particulier - Status: " & mstr_Status, Err.Description & " [" & UserID & "]") = 1 Then
710         GoTo lbl_Exit
720       Else
730         Resume Next
740       End If
End Function
                                                                              
Private Function Record_13_Particulier(aRs As ADODB.Recordset, aRsC As ADODB.Recordset) As Record_13_Particulier
          Dim t As Record_13_Particulier
          Dim i As Long
    
          ' R13A146_PA_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
10        On Error GoTo lbl_Error

20        t.R13A146_PA_CD_FILIALE = "N"
          ' R13N147_PA_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
30        t.R13N147_PA_CD_SYSSRCE = "1"
          ' R13N148_PA_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB – AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
40        t.R13N148_PA_NO_DEMANDE = CreateField(15, mstr_PCFINETNR, True, "0")
          ' R13N149_PA_Code_enreg      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘13’ | Code enregistrement | Constante vaut "13" | Valoriser à '13' | 0
50        t.R13N149_PA_Code_enreg = "13"
          ' R13A150_BLANC_183          As String * 40  ' 0020-0059 (040) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
60        t.R13A150_BLANC_183 = CreateField(40, "")
          ' R13N151_PA_MT_SALNET       As String * 14  ' 0060-0073 (014) | Netto loon                    | Alleen beschikbaar in PCFinet | Salaire mensuel net | "Montant du salaire mensuel de l'intervenant au moment de la dernière mise à jour de la demande, exprimé en Euro " | "nieuw vanuit PC-Finet over te nemen in PC-Retail - interface aanpassen new element to recuperate from PC-Finet - evolution of interface" | +9(9),9(3)
      'Debug.Assert (GetSaveNumber(aRsC!INKOMENNETTO) = 0)
70        t.R13N151_PA_MT_SALNET = CreateField(14, GetSaveNumber(aRsC!INKOMENNETTO), True, , "+000000000.000")
          ' R13A152_BLANC_185          As String * 28  ' 0074-0101 (028) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
80        t.R13A152_BLANC_185 = CreateField(28, "")
          ' R13N153_PA_MT_TOTREV       As String * 14  ' 0102-0115 (014) | Totaal maandelijkse inkomsten | Alleen beschikbaar in PCFinet | Montant total des revenus mensuels | "Montant total des revenus mensuels de l'intervenant au moment de la dernière mise à jour de la demande, exprimé en Euro " | "nieuw vanuit PC-Finet over te nemen in PC-Retail - interface aanpassen new element to recuperate from PC-Finet - evolution of interface" | +9(9),9(3)
90        t.R13N153_PA_MT_TOTREV = CreateField(14, GetSaveNumber(aRsC!INKOMENNETTOTOTAAL), True, , "+000000000.000")
          ' R13N154_PA_MT_SALMEN       As String * 14  ' 0116-0129 (014) | Netto loon huishouden per mnd | Alleen beschikbaar in PCFinet | Salaire mensuel net du ménage | "Montant du salaire mensuel du ménage de l'intervenat au moment de la dernière mise à jour de la demande, exprimé en Euro " | "nieuw vanuit PC-Finet over te nemen in PC-Retail - interface aanpassen new element to recuperate from PC-Finet - evolution of interface" | +9(9),9(3)
100       t.R13N154_PA_MT_SALMEN = CreateField(14, GetSaveNumber(aRsC!HUISHOUDGELD), True, , "+000000000.000")
          ' R13A155_BLANC_188          As String * 28  ' 0130-0157 (028) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
110       t.R13A155_BLANC_188 = CreateField(28, "")
          ' R13N156_PA_MT_TOREVMEN     As String * 14  ' 0158-0171 (014) | Totaal mnd inkomsten huishdn  | Alleen beschikbaar in PCFinet | Montant total des revenus mensuels du ménage | "Montant total des revenus mensuels du ménage de l'intervenant au moment de la dernière mise à jour de la demande, exprimé en Euro " | "nieuw vanuit PC-Finet over te nemen in PC-Retail - interface aanpassen new element to recuperate from PC-Finet - evolution of interface" | +9(9),9(3)
120       t.R13N156_PA_MT_TOREVMEN = CreateField(14, GetSaveNumber(aRsC!HUISHOUDGELDTOTAAL), True, , "+000000000.000")
          ' 101003 PROOVIT-EH: new field here
130       i = GetSaveNumber(aRs!AV_SCORE__AANTINKOMEN)
140       If i < 0 Then i = 0
150       If i > 2 Then i = 2 ' 101130 PROOVIT-EH: for some reason AV_SCORE__AANTINKOMEN is sometimes 3. We could not discover why. (Michel Preux and I)
160       t.R13N157_PERSONINKOM = CreateField(2, i, True, "0")

          ' R13A157_DUMMY_190          As String * 60  ' 0172-0233 (060) | Leeg                          | Leeg | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
          ' 101003 PROOVIT-EH: change lenght because of new field above
170       t.R13A158_DUMMY_190 = CreateField(60, "", , "X")
180       Record_13_Particulier = t

lbl_Exit:
190       Exit Function

lbl_Error:
200       Debug.Assert False
210       If HandleSilantError(Err.Number, "Module: INTF_BaleII_Module", "Record_13_Particulier - Status: " & mstr_Status, Err.Description & " [" & UserID & "]") = 1 Then
220         GoTo lbl_Exit
230       Else
240         Resume Next
250       End If
End Function
                                                                              
Private Function Record_14_Particulier(aRs As ADODB.Recordset, aRsC As ADODB.Recordset) As Record_14_Particulier
          Dim t As Record_14_Particulier
    
          ' R14A158_PA_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
10        On Error GoTo lbl_Error

20        t.R14A158_PA_CD_FILIALE = "N"
          ' R14N159_PA_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
30        t.R14N159_PA_CD_SYSSRCE = "1"
          ' R14N160_PA_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
40        t.R14N160_PA_NO_DEMANDE = CreateField(15, mstr_PCFINETNR, True, "0")
          ' R14N161_PA_Code_enreg      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘14’ | Code enregistrement | Constante vaut "14" | Valoriser à '14' | 0
50        t.R14N161_PA_Code_enreg = "14"
    
          ' R14A162_BLANC_195          As String * 14  ' 0020-0033 (014) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
60        t.R14A162_BLANC_195 = CreateField(14, "")
    
  
          ' R14N163_PA_MT_MENSPRET     As String * 14  ' 0034-0047 (014) | Mnd afbet. Lopende leningen   | Mogelijk beschikbaar in PCFinet | Mensualité des prêts en cours | "Mensualité des prêts en cours " | BKR / WFD - à vérifier avec Michel Preux si disponible dans PC-Finet | +9(9),9(3)
70        t.R14N163_PA_MT_MENSPRET = CreateField(14, GetSaveNumber(aRsC!OPENSTNDMNDBEDRAG), True, , "+000000000.000")
          ' R14A164_BLANC_197          As String * 52  ' 0048-0099 (052) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
80        t.R14A164_BLANC_197 = CreateField(52, "")
          ' R14N165_PA_MT_PRETMEN      As String * 14  ' 0100-0113 (014) | Mnd afbet. Lopnde lening tot. | Mogelijk beschikbaar in PCFinet | Mensualité des prêts en cours du ménage | "Mensualité des prêts en cours du ménage" | BKR / WFD - à vérifier avec Michel Preux si disponible dans PC-Finet | +9(9),9(3)
90        t.R14N165_PA_MT_PRETMEN = CreateField(14, GetSaveNumber(aRsC!OPENSTNDMNDBDRGHH), True, , "+000000000.000")
          ' R14N166_PA_MT_AUCHAMEN     As String * 14  ' 0114-0127 (014) | Mnd andere lasten huishouden  | Mogelijk beschikbaar in PCFinet | Montant mensuel des autres charges du ménage | "Montant mensuel des autres charges du ménage, exprimé en Euro" | BKR / WFD WOONLASTEN - à vérifier avec Michel Preux si disponible dans PC-Finet | +9(9),9(3)
100       t.R14N166_PA_MT_AUCHAMEN = CreateField(14, GetSaveNumber(aRsC!VASTELASTEN), True, , "+000000000.000")
          ' R14N167_PA_MT_TOTCHAMEN    As String * 14  ' 0128-0141 (014) | Totaal Mnd lasten huishouden  | Mogelijk beschikbaar in PCFinet | Montant total des charges mensuelles du ménage | "Montant total des charges mensuelles du ménage, exprimé en Euro" | BKR / WFD WOONLASTEN - à vérifier avec Michel Preux si disponible dans PC-Finet | +9(9),9(3)
110       t.R14N167_PA_MT_TOTCHAMEN = CreateField(14, GetSaveNumber(aRsC!TOTAALMAANDLASTEN), True, , "+000000000.000")
          ' R14N168_PA_TX_ENDETSF      As String * 8   ' 0142-0149 (008) | Taux d'endettement SF         | Mogelijk beschikbaar in PCFinet | Taux d'endettement SF | Montant de la plus grosse échéance de la demande exceptée la dernière / Revenu net mensuel global du demandeur | BKR / WFD - à vérifier avec Michel Preux si disponible dans PC-Finet | +9(3),9(3)
120       t.R14N168_PA_TX_ENDETSF = CreateField(8, GetSaveNumber(aRsC!PREC_SCHULDENLAST), True, , "+000.000") ' CreateField(14, GetSaveNumber(aRsC!HUISHOUDGELD), True, , "+000000000.000")
          ' R14N169_PA_TX_ENDETGL      As String * 8   ' 0150-0157 (008) | Status globale schuld         | Niet beschikbaar bij PFNE | Taux d'endettement global | (Montant global des charges mensuelles du demandeur + montant de la plus grosse échéance de la demande exceptée la dernière) / Revenu net mensuel global du demandeur | Information non disponible | +9(3),9(3)
130       t.R14N169_PA_TX_ENDETGL = CreateField(8, GetSaveNumber(aRsC!PREC_SCHULDLASTTOT), True, , "+000.000") ' CreateField(14, GetSaveNumber(aRsC!HUISHOUDGELD), True, , "+000000000.000")
          ' R14A170_BLANC_203          As String * 56  ' 0158-0213 (056) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
140       t.R14A170_BLANC_203 = CreateField(56, "")
          ' R14A171_DUMMY_204          As String * 20  ' 0214-0233 (020) | Leeg                          | Vullen met x-en | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
150       t.R14A171_DUMMY_204 = CreateField(20, "", , "X")
160       Record_14_Particulier = t

lbl_Exit:
170       Exit Function

lbl_Error:
180       Debug.Assert False
190       If HandleSilantError(Err.Number, "Module: INTF_BaleII_Module", "Record_14_Particulier - Status: " & mstr_Status, Err.Description & " [" & UserID & "]") = 1 Then
200         GoTo lbl_Exit
210       Else
220         Resume Next
230       End If
End Function
                                                                              
Private Function Record_15_Entreprise(aRs As ADODB.Recordset, aRsC As ADODB.Recordset) As Record_15_Entreprise
          Dim t As Record_15_Entreprise
    
          ' R15A172_EN_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
10        On Error GoTo lbl_Error

20        t.R15A172_EN_CD_FILIALE = "N"
          ' R15N173_EN_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
30        t.R15N173_EN_CD_SYSSRCE = "1"
          ' R15N174_EN_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
40        t.R15N174_EN_NO_DEMANDE = CreateField(15, mstr_PCFINETNR, True, "0")
          ' R15N175_EN_Code_enreg      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘15’ | Code enregistrement | Constante vaut "15" | Valoriser à '15' | 0
50        t.R15N175_EN_Code_enreg = "15"
    
          ' R15A176_EN_CD_IDNATIONAL   As String * 20  ' 0020-0039 (020) | Inschrijf nummer              | PCRetail DB - BEDRIJF . KVK_INSCHR | Numéro d'identifiant national | Numéro d'identifiant national pour une entreprise (exemple : en France c'est le numéro SIREN) | PCRetail - BEDRIJF / KVK_INSCHR | 0
60        t.R15A176_EN_CD_IDNATIONAL = CreateField(20, aRsC!KvK_Inschr & "")
          ' R15D177_EN_DT_CREAT        As String * 10  ' 0040-0049 (010) | Inschrijf datum               | PCRetail DB - BEDRIJF . KVK_OPRDATUM | Date de création de l'entreprise | "Date de création de l'entreprise Si la date est absente, mettre 01.01.1801" | PCRetail - BEDRIJF / KVK_OPRDATUM | DD.MM.YYYY
70        t.R15D177_EN_DT_CREAT = CreateField(10, CreateDate(aRsC!OprDatum, "01.01.1900"))
          ' R15A178_BLANC_211          As String * 9   ' 0050-0058 (009) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
80        t.R15A178_BLANC_211 = CreateField(9, "")
          ' R15A179_EN_CD_FORMJURI     As String * 6   ' 0059-0064 (006) | Rechtsvorm                    | PCRetail DB - BEDRIJF . RECHTSVORM | Code forme juridique | "Forme juridique de l'entreprise du demandeur au moment de la dernière mise à jour de la demande => Fournir la table de référence spécifique à la filiale" | "PCRetail - BEDRIJF / RECHTSVORM Fournir la table des formes juridiques spécifique à la filiale" | justifié à gauche (left), complété par des blancs à droite (rechts)
90        t.R15A179_EN_CD_FORMJURI = CreateField(6, AppCn.GetFieldValueBySQL("SELECT CDITEM FROM reftabel WHERE NMTAB = 'INGVRJ0' AND IDITEM = '" & aRsC!Rechtsvorm & "'", "") & "")
          ' R15A180_EN_CD_SECACTE      As String * 6   ' 0065-0070 (006) | Niet beschikbaar / Leeg       | 0 | Code secteur d'activité spécifique aux filiales | "Code brut du secteur d'activité de l'intervenant entreprise => Fournir la table de référence spécifique à la filiale" | Information non disponible | justifié à gauche (left), complété par des blancs à droite (rechts)
100       t.R15A180_EN_CD_SECACTE = CreateField(6, "")
          ' R15A181_EN_CD_SECACTECOM   As String * 6   ' 0071-0076 (006) | Niet beschikbaar / Leeg       | 0 | Code secteur d'activité commun aux filiales | "Code du secteur d'activité de l'intervenant entreprise dans le référentiel commun 0 : Non renseigné - Indéterminé 1 : Agriculture - Chasse - Sylviculture 2 : Pêche - Aquaculture 3 : Industries extractives 4 : Industries manufacturées 5 : Production Distribution électrique 6 : Construction 7 : Commerce - Réparation automobile 8 : Hôtel - Restaurant 9 : Transport - Communication 10 : Activités financières 11 : Immobilier 12 : Administration publique 13 : Education 14 : Santé - Action sociale 15 : Services collectifs sociaux 16 : Services domestiques 17 : Activités extra-territoriales 18 : Autres 19 : Média - Communication 20 : Marketing - Ventes" | Information non disponible | justifié à gauche (left), complété par des blancs à droite (rechts)
110       t.R15A181_EN_CD_SECACTECOM = CreateField(6, "")
          ' R15N182_EN_MT_CAPITAL      As String * 14  ' 0077-0090 (014) | Niet beschikbaar / Leeg       | 0 | Montant du capital de la société | "Montant du capital de la société" | Information non disponible | +9(9),9(3)
120       t.R15N182_EN_MT_CAPITAL = CreateField(14, "")
          ' R15N183_EN_MT_CA           As String * 14  ' 0091-0104 (014) | Niet beschikbaar / Leeg       | 0 | Montant du chiffre d'affaires | "Montant du chiffre d'affaire de l'entreprise publié au moment de l'extraction, exprimé en euro" | Information non disponible | +9(9),9(3)
130       t.R15N183_EN_MT_CA = CreateField(14, "")
          ' R15A184_BLANC_217          As String * 24  ' 0105-0128 (024) | Niet beschikbaar / Leeg       | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
140       t.R15A184_BLANC_217 = CreateField(24, "")
          ' R15N185_EN_NB_EFFECTIF     As String * 5   ' 0129-0133 (005) | Niet beschikbaar / Leeg       | 0 | Nombre d'employés dans l'entreprise | "Effectif de l'entreprise du demandeur au moement de la dernière mise à jour de la demande" | Information non disponible | 9(5)
150       t.R15N185_EN_NB_EFFECTIF = CreateField(5, "")
          ' R15A186_EN_CD_TRANCHEFF    As String * 6   ' 0134-0139 (006) | Niet beschikbaar / Leeg       | 0 | Tranche d'effectif dans l'entreprise | "Tranche d'effectif à laquelle appartient l'entreprise au moment de la dernière mise à jour de la demande Ce champ n'est pas renseigné si l'effectif de l'entreprise est fournie sinon, suivre le référentiel ci-dessous 0 : Non renseigné / Indéterminé 1 : 1 Employé 2 : 2 à 5 Employés 3 : 6 à 10 Employés 4 : 11 à 50 Employés 5 : 51 à 100 Employés 6 : >= 101 Employés" | Information non disponible | justifié à gauche (left), complété par des blancs à droite (rechts)
160       t.R15A186_EN_CD_TRANCHEFF = CreateField(6, "")
          ' R15A187_DUMMY_220          As String * 94  ' 0140-0233 (094) | Leeg                          | 0 | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
170       t.R15A187_DUMMY_220 = CreateField(94, "", , "X")
180       Record_15_Entreprise = t

lbl_Exit:
190       Exit Function

lbl_Error:
200       Debug.Assert False
210       If HandleSilantError(Err.Number, "Module: INTF_BaleII_Module", "Record_15_Entreprise - Status: " & mstr_Status, Err.Description & " [" & UserID & "]") = 1 Then
220         GoTo lbl_Exit
230       Else
240         Resume Next
250       End If
End Function
                                                                              
Private Function Record_16_Decision(aRs As ADODB.Recordset) As Record_16_Decision
          Dim t As Record_16_Decision
          Dim s As String
    
          ' R16A188_DD_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
10        On Error GoTo lbl_Error

20        t.R16A188_DD_CD_FILIALE = "N"
          ' R16N189_DD_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
30        t.R16N189_DD_CD_SYSSRCE = "1"
          ' R16N190_DD_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
40        t.R16N190_DD_NO_DEMANDE = CreateField(15, mstr_PCFINETNR, True, "0")
          ' R16N191_DD_Code_enreg      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘16’ | Code enregistrement | Constante vaut "16" | Valoriser à '16' | 0
50        t.R16N191_DD_Code_enreg = "16"
    
          ' R16A192_BLANC_225          As String * 1   ' 0020-0020 (001) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
60        t.R16A192_BLANC_225 = CreateField(1, "")
          ' R16D193_DD_DT_DECISYST     As String * 10  ' 0021-0030 (010) | Beslissing in systeem         | Constante: ’01.01.1801’ | Date de décision système | Date de décision système | "Default waarde = 01.01.1801 Renseigner par la valeur par défaut: 01.01.1801" | DD.MM.YYYY
70        t.R16D193_DD_DT_DECISYST = CreateField(10, "01.01.1801")
          ' R16A194_BLANC_227           As String * 6   ' 0031-0036 (006) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
80        t.R16A194_BLANC_227 = CreateField(6, "")
          ' R16D195_DD_DT_DECIACC      As String * 10  ' 0037-0046 (010) | Datum akkoord                 | Constante: ’01.01.1801’ | Date de décision accord | Date de décision accord | "Default waarde = 01.01.1801 Renseigner par la valeur par défaut: 01.01.1801" | DD.MM.YYYY
90        t.R16D195_DD_DT_DECIACC = CreateField(10, "01.01.1801")
          ' R16A196_BLANC_229          As String * 120 ' 0047-0166 (120) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
100       t.R16A196_BLANC_229 = CreateField(120, "")
          ' R16A197_IN_CD_TRASCORE3    As String * 2   ' 0167-0168 (002) | Score                         | Formaat score = letter (Zie punt 110) | Tranche de score finale | Tranche de score finale | Formaat score = letter bv A // nog uit te zoeken in PC-Retail | 0
          ' 101003 PROOVIT-EH: Use it for status number iso SCORE klasse
110       s = aRs!AV_SCORE__AVSTATUS & ""
120       If IsNumeric(s) Then
130           If CLng(s) > 100 Then s = "99"
140           If CLng(s) < 0 Then s = "0"
150       Else
160           s = "0"
170       End If
180       t.R16A197_IN_CD_TRASCORE3 = CreateField(2, s, True, "0")
          ' R16A198_BLANC_231          As String * 65  ' 0169-0233 (065) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
190       t.R16A198_BLANC_231 = CreateField(65, "", , "X")
200       Record_16_Decision = t

lbl_Exit:
210       Exit Function

lbl_Error:
220       Debug.Assert False
230       If HandleSilantError(Err.Number, "Module: INTF_BaleII_Module", "Record_16_Decision - Status: " & mstr_Status, Err.Description & " [" & UserID & "]") = 1 Then
240         GoTo lbl_Exit
250       Else
260         Resume Next
270       End If
End Function

Private Function Record_22_Palier(aRs As ADODB.Recordset, ByVal aIsBalloon As Boolean, ByVal aPalierNr As Byte) As Record_22_Palier
          Dim t As Record_22_Palier
          Dim LT As Long
    
          ' R22A199_PL_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
10        On Error GoTo lbl_Error

20        t.R22A199_PL_CD_FILIALE = "N"
          ' R22N200_PL_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
30        t.R22N200_PL_CD_SYSSRCE = "1"
          ' R22N201_PL_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
40        t.R22N201_PL_NO_DEMANDE = CreateField(15, mstr_PCFINETNR, True, "0")
          ' R22N202_PL_Code_enreg      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘22’ | Code enregistrement | Constante vaut "22" | Valoriser à '22' | 0
50        t.R22N202_PL_Code_enreg = "22"
    
          ' R22N203_PL_NO_PALIER       As String * 3   ' 0020-0022 (003) | Nummer palier                 | 01 voor normaal contract 01 of 02 voor balloon (2 records voor balloon) | Numéro de palier | Numéro de palier | " = 01 vor normaal contract /// 01 en 02 voor balloon (2 records voor balloon) = 01 for normal contract /// 01 or 02 for balloon (2 records for balloon)" | justifié à droite (rechts), complété par des zéros à gauche (left)
60        t.R22N203_PL_NO_PALIER = CreateField(3, aPalierNr, True, "0")
          ' R22A204_BLANC_237          As String * 6   ' 0023-0028 (006) | Leeg                          | 0 | Champs non renseignés pour Bâle II | Blanc | 0 | 0
70        t.R22A204_BLANC_237 = CreateField(6, "")
    
80        If aPalierNr = 1 Then
90            On Error Resume Next ' prevent resul -1
100           LT = 0
110           LT = CLng("0" & Trim(aRs!AV_FIN__LOOPTIJD & ""))
120           If aIsBalloon Then LT = LT - 1
130           If LT < 0 Then LT = 0
140           On Error GoTo 0
              ' R22N205_PL_MT_ECH          As String * 14  ' 0029-0042 (014) | Termijn bedrag palier         | 1e record : PCRetail - AV_FIN / TERMIJN voor normaal contract en balloon ; 2e record : TERMIJN + RESTANT enkel voor balloon | Montant de l'échéance du palier | Montant de l'échéance du palier, exprimé en Euro | "PCRetail - AV_FIN / 1e record 22 : TERMIJN voor normaal contract en balloon /// 2e record 22 : TERMIJN + RESTANT enkel voor balloon 1st record 22 : TERMIJN for normal contract and for balloon // 2nd record 22 : TERMIJN + RESTANT only for balloon" | +9(9),9(3)
150           t.R22N205_PL_MT_ECH = CreateField(14, GetSaveNumber(aRs!AV_FIN__TERMIJN), True, , "+000000000.000", aUsePositiveNegativeForNr:=True)
              ' R22N206_PL_DU_PALIER       As String * 3   ' 0043-0045 (003) | Duur in mnd vd palier         | 1e record : LOOPTIJD voor normale contracten en (LOOPTIJD - 1) voor balloon ; 2e record : enkel voor balloon : 1 voor balloon | Durée du palier exprimé en mois | Durée du palier exprimé en mois | "PCRetail - 1e record 22 : LOOPTIJD voor normale contracten en (LOOPTIJD - 1) voor balloon /// 2e record 22 enkel voor balloon : 1 voor balloon 1st record 22 : LOOPTIJD for normal contracts and (LOOPTIJD - 1) for balloon /// 2nd record 22 only for balloon : 1 for balloon" | 9(3)
160           t.R22N206_PL_DU_PALIER = CreateField(3, LT - IIf(aIsBalloon, 1, 0), True, "0")
              ' R22N207_PL_NB_ECH          As String * 3   ' 0046-0048 (003) | Aantal termijnen in de palier | 1e record : LOOPTIJD voor normale contracten en (LOOPTIJD - 1) voor balloon ; 2e record : enkel voor balloon : 1 voor balloon | Nombre d'échéances dans le palier | Nombre d'échéances dans le palier | "PCRetail - 1e record 22 : LOOPTIJD voor normale contracten en (LOOPTIJD - 1) voor balloon /// 2e record 22 enkel voor balloon : 1 voor balloon 1st record 22 : LOOPTIJD for normal contracts and (LOOPTIJD - 1) for balloon /// 2nd record 22 only for balloon : 1 for balloon" | 9(3)
170           t.R22N207_PL_NB_ECH = CreateField(3, LT - IIf(aIsBalloon, 1, 0), True, "0")
              ' R22D208_PL_DT_DEB          As String * 10  ' 0049-0058 (010) | Begindatum palier             | 1e record : PCRetail DB - AV_ALG . TEK_DATUM | Date de début de palier | "Date de début de palier, Si la date est absente, mettre 01.01.1801" | PCRetail - AV_ALG / TEK_DATUM voor 1e record 22 - for 1st record 22 | DD.MM.YYYY
180           t.R22D208_PL_DT_DEB = CreateField(10, CreateDate(aRs!AV_ALG__TEK_DATUM, "01.01.1801"))
              ' R22D209_PL_DT_FIN          As String * 10  ' 0059-0068 (010) | Einddatum palier              | 1e record : PCRetail DB - AV_FIN / EIND_DATUM ; 2e record : (EIND_DATUM - 1) voor balloon | Date de fin de palier | "Date de fin de palier Si la date est absente, mettre 01.01.1801" | "PCRetail - AV_FIN / EIND_DATUM voor 1e record 22 /// (EIND_DATUM - 1) voor 2e record balloon EIND_DATUM for 1st record 22 /// (EIND_DATUM - 1) for 2nd record balloon" | DD.MM.YYYY
190           t.R22D209_PL_DT_FIN = CreateField(10, CreateDate(aRs!AV_FIN__EINDDATUM, "01.01.1801"))
200       End If
210       If aPalierNr = 2 Then ' always a balloon
              ' R22N205_PL_MT_ECH          As String * 14  ' 0029-0042 (014) | Termijn bedrag palier         | 2e record : TERMIJN + RESTANT enkel voor balloon | Montant de l'échéance du palier | Montant de l'échéance du palier, exprimé en Euro | "PCRetail - AV_FIN / 1e record 22 : TERMIJN voor normaal contract en balloon /// 2e record 22 : TERMIJN + RESTANT enkel voor balloon 1st record 22 : TERMIJN for normal contract and for balloon // 2nd record 22 : TERMIJN + RESTANT only for balloon" | +9(9),9(3)
220           t.R22N205_PL_MT_ECH = CreateField(14, GetSaveNumber(aRs!AV_FIN__TERMIJN) + GetSaveNumber(aRs!AV_FIN__RESTANTBET), True, , "+000000000.000", aUsePositiveNegativeForNr:=True)
              ' R22N206_PL_DU_PALIER       As String * 3   ' 0043-0045 (003) | Duur in mnd vd palier         | 2e record : enkel voor balloon : 1 voor balloon | Durée du palier exprimé en mois | Durée du palier exprimé en mois | "PCRetail - 1e record 22 : LOOPTIJD voor normale contracten en (LOOPTIJD - 1) voor balloon /// 2e record 22 enkel voor balloon : 1 voor balloon 1st record 22 : LOOPTIJD for normal contracts and (LOOPTIJD - 1) for balloon /// 2nd record 22 only for balloon : 1 for balloon" | 9(3)
230           t.R22N206_PL_DU_PALIER = CreateField(3, 1, True, "0")
              ' R22N207_PL_NB_ECH          As String * 3   ' 0046-0048 (003) | Aantal termijnen in de palier | 2e record : enkel voor balloon : 1 voor balloon | Nombre d'échéances dans le palier | Nombre d'échéances dans le palier | "PCRetail - 1e record 22 : LOOPTIJD voor normale contracten en (LOOPTIJD - 1) voor balloon /// 2e record 22 enkel voor balloon : 1 voor balloon 1st record 22 : LOOPTIJD for normal contracts and (LOOPTIJD - 1) for balloon /// 2nd record 22 only for balloon : 1 for balloon" | 9(3)
240           t.R22N207_PL_NB_ECH = CreateField(3, 1, True, "0")
              ' R22D208_PL_DT_DEB          As String * 10  ' 0049-0058 (010) | Begindatum palier             | 1e/2e record : PCRetail DB - AV_ALG . TEK_DATUM | Date de début de palier | "Date de début de palier, Si la date est absente, mettre 01.01.1801" | PCRetail - AV_ALG / TEK_DATUM voor 1e record 22 - for 1st record 22 | DD.MM.YYYY
250           t.R22D208_PL_DT_DEB = CreateField(10, CreateDate(aRs!AV_ALG__TEK_DATUM, "01.01.1801"))
              ' R22D209_PL_DT_FIN          As String * 10  ' 0059-0068 (010) | Einddatum palier              | 1e/2e record : PCRetail DB - AV_FIN / EIND_DATUM ; 2e record : (EIND_DATUM - 1) voor balloon | Date de fin de palier | "Date de fin de palier Si la date est absente, mettre 01.01.1801" | "PCRetail - AV_FIN / EIND_DATUM voor 1e record 22 /// (EIND_DATUM - 1) voor 2e record balloon EIND_DATUM for 1st record 22 /// (EIND_DATUM - 1) for 2nd record balloon" | DD.MM.YYYY
260           t.R22D209_PL_DT_FIN = CreateField(10, CreateDate(aRs!AV_FIN__EINDDATUM, "01.01.1801"))
270       End If
    
          ' R22A210_DUMMY_243          As String * 165 ' 0069-0233 (165) | Leeg                          | Vullen met x-en | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
280       t.R22A210_DUMMY_243 = CreateField(165, "", , "X")

290       Record_22_Palier = t

lbl_Exit:
300       Exit Function

lbl_Error:
310       Debug.Assert False
320       If HandleSilantError(Err.Number, "Module: INTF_BaleII_Module", "Record_22_Palier - Status: " & mstr_Status, Err.Description & " [" & UserID & "]") = 1 Then
330         GoTo lbl_Exit
340       Else
350         Resume Next
360       End If
End Function
                                                                                                                                                                                                                                                               
Private Function Record_23_Bale_II(aRs As ADODB.Recordset) As Record_23_Bale_II
          Dim t As Record_23_Bale_II
    
          ' R23A211_DE_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
10        On Error GoTo lbl_Error

20        t.R23A211_DE_CD_FILIALE = "N"
          ' R23N212_DE_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
30        t.R23N212_DE_CD_SYSSRCE = "1"
          ' R23N213_DE_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
40        t.R23N213_DE_NO_DEMANDE = CreateField(15, mstr_PCFINETNR, True, "0")
          ' R23N214_DE_Code_enreg      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘23’ | Code enregistrement | Constante vaut "23" | Valoriser à '23' | 0
50        t.R23N214_DE_Code_enreg = "23"
    
          ' R23N215_GA_MT_GARANT       As String * 14  ' 0020-0033 (014) | Bedrag                        | PCRetail DB - AV_FIN . MAANDBEDRAG * LOOPTIJD + RESTANT – FIN_BEDRAG | Montant de la garantie | "Il s'agit du montant pour lequel il y a un garant (ne correspond pas forcément au montant du prêt financé, exemple du concessionnaire en Allemagne) si garantie à 100% du montant, mettre le montant" | PCRetail - AV_FIN / MAANDBEDRAG * LOOPTIJD + RESTANT - FIN_BEDRAG | +9(9),9(3)
60        t.R23N215_GA_MT_GARANT = CreateField(14, (GetSaveNumber(aRs!AV_FIN__TERMIJN) * GetSaveNumber(Trim(aRs!AV_FIN__LOOPTIJD & ""))) + GetSaveNumber(aRs!AV_FIN__RESTANTBET) - GetSaveNumber(aRs!AV_FIN__FIN_BEDRAG), True, , "+000000000.000", aUsePositiveNegativeForNr:=True)
          ' R23A216_GA_CD_NATURE       As String * 6   ' 0034-0039 (006) | Code bedrag                   | Leeg | Code nature de la garantie | Renseigner le champ à blanc | blanco | justifié à gauche (left), complété par des blancs à droite (rechts)
70        t.R23A216_GA_CD_NATURE = CreateField(6, "")
          ' R23A217_DE_CD_TYPDEM       As String * 1   ' 0040-0040 (001) | Client code                   | 0 = Bedrijf : Nog te bepalen ; 1= Particulier: Niet-bedrijf ;2 = Medewerker: dealer= 009200 of 900200 | Code client | "Type du demandeur : 0 : Entreprise 1 : Particulier 2 : Employé" | "PCRetail - uit zoeken bedrijf - patriculier /// voor employé PSA (= 2) dealer = 009200 en 900200 to look-up whow to make the difference between Etreprise and Particulier /// For emplyees PSA (= 2) dealer = 009200 and 900200" | justifié à gauche (left), complété par des blancs à droite (rechts)
80        If AppCn.GetFieldValueBySQL("SELECT Count(AANVRAAGNR) FROM BEDRIJF WHERE AANVRAAGNR = '" & aRs!AV_ALG__AANVRAAGNR & "'", 0) > 0 Then
90            t.R23A217_DE_CD_TYPDEM = CreateField(1, "0")
100       Else
110           t.R23A217_DE_CD_TYPDEM = CreateField(1, "1")
120       End If
          ' R23N218_DE_MT_DEPGAR       As String * 14  ' 0041-0054 (014) | Niet beschikbaar              | Waarde op 0? | Valeur du dépôt de garantie | Apport pour le leasing | Information non disponible | +9(9),9(3)
130       t.R23N218_DE_MT_DEPGAR = CreateField(14, "0")
          ' R23N219_DE_NB_VEHICULE     As String * 3   ' 0055-0057 (003) | Niet beschikbaar              | Constante: 999 | Nombre de véhicules | "Nombre de véhicules au total du client en cours de paiement Valeur par défaut: 999" | Information non disponible | 9(3)
140       t.R23N219_DE_NB_VEHICULE = CreateField(3, "999")
          ' R23D220_DE_DT_EXTRACT      As String * 10  ' 0058-0067 (010) | Datum gegevens                | Datum extractie | Date d'extraction des données | "Date à laquelle l'extraction a été faite Date du jour. Elle est requise. " | "extractiedatum van bestand creation date of the extraction file" | DD.MM.YYYY
150       t.R23D220_DE_DT_EXTRACT = CreateField(10, CreateDate(Now))
          ' R23A221_DE_TM_RETCOR       As String * 1   ' 0068-0068 (001) | Retail of corporate           | Vullen met spaties | Champ Retail / Corporate | "flag mis à R : Retail C : Corporate Cette notion est en cours de définition auprès des fonctionnels, ce champ doit être initialisé à blanc" | "altijd = blanco laten always = spaces Renseigner plutôt par la valeur par défaut: un espace vide" | 0
160       t.R23A221_DE_TM_RETCOR = CreateField(1, "")
          ' R23A222_TM_LIGNEC          As String * 1   ' 0069-0069 (001) | Leeg                          | 0 | Ligne de crédit | "Témoin indiquant si le financement demandé correspond à un montant de financement ou à un véhicule. 0 : la demande de financement ne correspond pas à une ligne de crédit 1 : La demande de financement est une ligne de crédit. Pour l'instant, renseigner ce champ à blanc" | blanco | 0
170       t.R23A222_TM_LIGNEC = CreateField(1, "")
          ' R23N223_CA_CONSO           As String * 20  ' 0070-0089 (020) | CA consolidé du groupe        | Constante: +999999999999999,999 | CA consolidé du groupe | "Montant du CA du groupe auquel la société est rattaché Pour l'instant, renseigner ce champ à +999999999999999,999" | Information non disponible | +9(15),9(3)
180       t.R23N223_CA_CONSO = CreateField(20, "+999999999999999,999")
          ' R23A224_DE_CD_DEVISE       As String * 3   ' 0090-0092 (003) | Valuta                        | Constante:’EUR’ | Code Devise ISO | DE_CD_DEVISE | Valoriser par 'EUR' | 0
190       t.R23A224_DE_CD_DEVISE = CreateField(3, "EUR")
          ' R23D225_DE_DT_LIQUIDATION  As String * 10  ' 0093-0102 (010) | Liquidatie datum              | Niet beschikbaar bij PFNE | Date de Liquidation | Date de liquidation du contrat Wholesale | Information non disponible | DD.MM.YYYY
200       t.R23D225_DE_DT_LIQUIDATION = CreateField(10, "")
          ' 101123 PROOVIT-EH: new field  @ request of mustapha.touile@ext.mpsa.com:
210       t.R23D226_CODEBACKOFFICEDES = "3"
          ' R23A226_DUMMY_259          As String * 131 ' 0104-0233 (130) | Leeg                          | Vullen met x-en | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
220       t.R23A227_DUMMY_259 = CreateField(130, "", , "X")
    
230       Record_23_Bale_II = t

lbl_Exit:
240       Exit Function

lbl_Error:
250       Debug.Assert False
260       If HandleSilantError(Err.Number, "Module: INTF_BaleII_Module", "Record_23_Bale_II - Status: " & mstr_Status, Err.Description & " [" & UserID & "]") = 1 Then
270         GoTo lbl_Exit
280       Else
290         Resume Next
300       End If
End Function


Private Function Record_DetailDuScoring_DetailDuScoring(aRs As ADODB.Recordset, ByVal aRecordCounter As Long) As Record_DetailDuScoring_DetailDuScoring
          Dim t As Record_DetailDuScoring_DetailDuScoring
          Dim s As String
    
          'R50A001_DE_CD_FILIALE      As String * 1   ' 0001-0001 (001) | Filiaal code                  | Constante: ‘N’ | Code filiale | "Code du pays d'où est extraite la demande Voir table de référence PY0 (onglet PY0)" | Pour la Hollande, valoriser à N | 0
10        On Error GoTo lbl_Error

20        t.R50A001_DE_CD_FILIALE = "N"
          'R50N002_DE_CD_SYSSRCE      As String * 1   ' 0002-0002 (001) | Bron nummer                   | Constante: 1 (PCRetail) | Code système source | "Code du système source d'où est extraite la demande Table de référence" | "Pour GVAC, valoriser à 3 Pour PC-Retail, valoriser à 1" | 0
30        t.R50N002_DE_CD_SYSSRCE = "1"
          'R50N003_DE_NO_DEMANDE      As String * 15  ' 0003-0017 (015) | Aanvraagnummer                | PCRetail DB - AV_ALG . PCFINETNR | Numéro de la demande | Clé d'unicité de la demande dans le système d'exploitation dont elle est extraite et doit correspondre à la dernière version de la demande | PCRetail - AV_ALG / PCFINETNR | justifié à droite (rechts), complété par des zéros à gauche (left)
40        t.R50N003_DE_NO_DEMANDE = CreateField(15, mstr_PCFINETNR, True, "0")
          'R50N004_DE_Code_enreg      As String * 2   ' 0018-0019 (002) | Recordnummer                  | Constante: ‘50’ | Code enregistrement | Constante vaut "23" | Valoriser à '23' | 0
50        t.R50N004_DE_Code_enreg = "50"
          'R50N005_DetailDuScoring    As String * 60  ' 0020-0079 (060) | Scoring                       | Le résultat des différents critères du tableau du scoring VAC-PFNE
60        s = s & CreateField(3, aRecordCounter, True, "0")
70        s = s & CreateField(3, GetSaveNumber(aRs!REG_CODE), True, "0")
80        s = s & CreateField(3, GetSaveNumber(aRs!COND_NR), True, "0")
90        s = s & CreateField(3, GetSaveNumber(aRs!Cond_Score), True, "0")
100       s = s & CreateField(3, GetSaveNumber(aRs!AFWIJS_REG_CODE), True, "0")
110       s = s & CreateField(3, GetSaveNumber(aRs!ZEKERH_CODE), True, "0")
120       s = s & CreateField(3, GetSaveNumber(aRs!INFO_REG_CODE), True, "0")
130       t.R50N005_DetailDuScoring = CreateField(60, s)
          ' R50A006_DUMMY_501          As String * 154 ' 0080-0233 (154) | Leeg                          | Vullen met x-en | Bourrage de ligne | Le caractère de bourrage de ligne est 'X' | 0 | Ligne complétée par des X
140       t.R50A006_DUMMY_501 = CreateField(154, "", , "X")
    
150       Record_DetailDuScoring_DetailDuScoring = t

lbl_Exit:
160       Exit Function

lbl_Error:
170       Debug.Assert False
180       If HandleSilantError(Err.Number, "Module: INTF_BaleII_Module", "Record_DetailDuScoring_DetailDuScoring - Status: " & mstr_Status, Err.Description & " [" & UserID & "]") = 1 Then
190         GoTo lbl_Exit
200       Else
210         Resume Next
220       End If
End Function

'******************************************************************************************************************************************************************************************************************************
'*****************************  HELPER FUNCTIONS ******************************************************************************************************************************************************************************
'******************************************************************************************************************************************************************************************************************************

Private Function HandleSilantError(aErrNr As Long, aSource1 As String, aSource2 As String, aErrDesc As String) As Long
10        If AutoPilot Then
20            mstr_ErrLog = mstr_ErrLog & "Error #" & aErrNr & " " & aErrDesc & "  in [" & aSource1 & "].[" & aSource2 & "].[" & Erl & "]" & vbCrLf
30            HandleSilantError = -1 ' resume
40        Else
50            HandleSilantError = HandleError(PsaApp_PCRetail, aErrNr, aSource1, aSource2, aErrDesc)
60        End If
End Function



Private Function CreateDate(ByVal aDate, Optional ByVal aEmptyString As String = "")
10        If IsNull(aDate) Then
20            CreateDate = aEmptyString
30        Else
40            CreateDate = Format(CDate(aDate), "dd.mm.yyyy")
50        End If
End Function

Public Function GetSaveNumber(ByVal aNumber As Variant, Optional ByVal aDefault As Double = 0) As Double
10        On Error Resume Next
20        GetSaveNumber = aDefault
30        GetSaveNumber = CDbl(aNumber)
End Function

Public Function CreateField(ByVal aLength As Long, ByVal aValue As String, Optional ByVal aRightAlign As Boolean = False, Optional ByVal aFillChar As String = " ", Optional ByVal aFormat, Optional ByVal aTrimValue As Boolean = True, Optional ByVal aUsePositiveNegativeForNr As Boolean = False) As String
          Dim v
          Dim Pos As Boolean
10        v = aValue
    
20        If aUsePositiveNegativeForNr Then
30            If v < 0 Then Pos = False Else Pos = True
40            v = Abs(v) ' remove negative sign
50        End If
60        If aTrimValue Then v = Trim(v)
70        If Not IsMissing(aFormat) Then
80            v = Format(v, aFormat)
90            If aUsePositiveNegativeForNr And Not Pos Then
100               v = Replace(v, "+", "-", , , vbTextCompare)
110           End If
120       End If
130       If Len(v) > aLength Then
140           Debug.Assert False
150           CreateField = v
160       ElseIf Len(v) = aLength Then
170           CreateField = v
180       Else
190           If Not aRightAlign Then
200               CreateField = v & String(aLength - Len(v), aFillChar)
210           Else
220               CreateField = String(aLength - Len(v), aFillChar) & v
230           End If
240       End If
End Function

